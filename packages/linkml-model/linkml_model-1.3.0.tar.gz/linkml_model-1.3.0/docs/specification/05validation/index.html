<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../../img/favicon.ico" rel="shortcut icon"/>
<title>Instance Validation - LinkML Model</title>
<link href="../../css/theme.css" rel="stylesheet"/>
<link href="../../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "Instance Validation";
        var mkdocs_page_input_path = "specification/05validation.md";
        var mkdocs_page_url = null;
      </script>
<script defer="" src="../../js/jquery-3.6.0.min.js"></script>
<!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-2SYBSJVZ23"></script>
<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-2SYBSJVZ23');
      </script>
</head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../.."> LinkML Model
        </a><div role="search">
<form action="../../search.html" class="wy-form" id="rtd-search-form" method="get">
<input name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../home/">About</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Specification</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../00preamble/">Preface</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../01introduction/">Introduction</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../02instances/">Instances</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../03schemas/">Schema Datamodel</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../04derived-schemas/">Derived Schemas</a>
</li>
<li class="toctree-l1 current"><a class="reference internal current" href="./">Instance Validation</a>
<ul class="current">
<li class="toctree-l2"><a class="reference internal" href="#validation-of-classdefinitions">Validation of ClassDefinitions</a>
<ul>
<li class="toctree-l3"><a class="reference internal" href="#cd-rule-assignment-values-must-be-valid">CD Rule: Assignment values must be valid</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cd-rule-classdefinition-instances-must-instantiate-a-class-in-the-schema">CD Rule: ClassDefinition instances must instantiate a class in the schema</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cd-rule-identifiers-must-be-unique">CD Rule: identifiers must be unique</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#cd-rule-all-assignments-must-be-to-permitted-slots">CD Rule: All assignments must be to permitted slots</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rule-all-required-slots-must-be-specified">Rule: All required slots must be specified</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rule-all-recommended-slots-should-be-specified">Rule: All recommended slots should be specified</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rule-assigned-values-must-conform-to-multivalued-cardinality">Rule: Assigned values must conform to multivalued cardinality</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rule-values-should-be-within-stated-bounds">Rule: values should be within stated bounds</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rule-values-should-equal-evaluable-expression">Rule: values should equal evaluable expression</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rule-values-should-equal-string_serialization">Rule: values should equal string_serialization</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rule-values-should-equal-regular-expression-patterns">Rule: values should equal regular expression patterns</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#range-class-instantiation-check">Range class instantiation check</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#range-type-check">Range type check</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#range-enum-check">Range enum check</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#boolean-combinations-of-expressions">Boolean combinations of expressions</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#range-expression-checks">range expression checks</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rule-evaluation">Rule evaluation</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#classification-rule-evaluation">Classification Rule evaluation</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#type-designator-checks">type designator checks</a>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#inference-of-new-values">Inference of new values</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../06mapping/">Mapping of Instances</a>
</li>
</ul>
<p class="caption"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../..">Metamodel</a>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../..">LinkML Model</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a alt="Docs" class="icon icon-home" href="../.."></a> »</li>
<li>Specification »</li><li>Instance Validation</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<h1 id="validation-using-schemas">Validation using Schemas</h1>
<p><strong>Validation</strong> is a procedure that takes as input:</p>
<ul>
<li>A LinkML instance structure <code>i</code>, where <code>i</code> is to be validated</li>
<li>A LinkML instance structure <code>root</code>. This may be the same as <code>i</code></li>
<li>A <em>derived</em> schema <code>m*</code></li>
</ul>
<p>The validation procedure will produce output that can be used to determine if the instance is <em>structurally and semantically valid</em> according to the schema.</p>
<div class="mermaid">flowchart TD
    M[Asserted Schema] --&gt; Derivation{Derivation Procedure}
    Derivation --&gt;|derives| Mstar[Derived Schema]
    R[Rules] --&gt; Derivation
    I[Instance] --&gt; Validation{Validation Procedure}
    Validation --&gt;|produces| Results[Validation Results]
    Mstar --&gt; Validation
</div>
<p>The following holds for any validation procedure:</p>
<ul>
<li>The output MUST include a boolean slot indicating whether the input can be demonstrated to be false</li>
<li>The output SHOULD include additional information about the nature of all problems encountered. </li>
<li>The output SHOULD be conformant with the LinkML validation schema.</li>
<li>The output MAY also return cases where <em>recommendations</em> are not adhered to</li>
<li>The output MAY also be combined with parsing to yield the precise location (i.e. line numbers) in the source serialization document where problems are found.</li>
<li>The procedure MAY restrict validation to defined subsets (profiles) of the Metamodel</li>
<li>The procedure  SHOULD return in its payload an indication of which profile and version is used.</li>
</ul>
<p>The validation procedure is to first take the metaclass that is instantiated by the type of the instance <code>i</code>,
and apply one of the 4 checks below, with each check performing its own sub-rules. The ClassDefinition check
is <em>recursive</em>, checking each slot-value assignment. This means a check on any instance will always validate the
full instance tree.</p>
<h2 id="validation-of-classdefinitions">Validation of ClassDefinitions</h2>
<p>Given an instance <code>i</code> of a ClassDefinition:</p>
<p><em>ClassDefinitionName</em>( <code>SVs</code> )</p>
<p>Where <code>SVs</code> is a collection of length <code>N</code>, with index <code>i..N</code> and members <code>slot_i=value_i</code>,
and <em>ClassDefinitionName</em> is the name of a ClassDefinition in <code>m*</code>, such that <code>C=m*.classes[ClassDefinitionName]</code></p>
<h3 id="cd-rule-assignment-values-must-be-valid">CD Rule: Assignment values must be valid</h3>
<p>for each <code>slot=value</code> assignment in <code>SVs</code>, the validation procedure is performed on <code>value</code>, with
<code>root</code> remaining the same</p>
<h3 id="cd-rule-classdefinition-instances-must-instantiate-a-class-in-the-schema">CD Rule: ClassDefinition instances must instantiate a class in the schema</h3>
<p><em>ClassDefinitionName</em> MUST be the name of a ClassDefinition in <code>m*</code></p>
<p><code>C</code> is assigned to be the value of <code>m*[ClassDefinitionName]</code></p>
<p><code>Atts</code> is assigned to be the value of <code>C.attributes</code> (see the previous section)</p>
<p><code>C</code> SHOULD have all the following properties:</p>
<ul>
<li><code>C.deprecated</code> SHOULD be <strong>None</strong></li>
<li><code>C.abstract</code> SHOULD NOT be <strong>True</strong></li>
<li><code>C.mixin</code> SHOULD NOT be <strong>True</strong></li>
</ul>
<h3 id="cd-rule-identifiers-must-be-unique">CD Rule: identifiers must be unique</h3>
<p>We define a procedure <strong>IdVal</strong>(<code>i</code>) which yields the value of <code>i.&lt;identifier_slot&gt;</code> where <code>identifier_slot</code>
is the slot n <code>Atts</code> with metaslot assignment <code>identifier</code>=<strong>True</strong></p>
<p>If there is no such slot then <code>**IdVal**(</code>i`) is None and this check is ignored.</p>
<p><code>i</code> is invalid if there exists another instance <code>j</code> such that <code>j</code> is reachable from <code>root</code>,
and <strong>IdVal</strong>(<code>i</code>)=<strong>IdVal</strong>(<code>j</code>) and <code>i</code> and <code>j</code> are distinct.</p>
<h3 id="cd-rule-all-assignments-must-be-to-permitted-slots">CD Rule: All assignments must be to permitted slots</h3>
<p>For each <code>s=value</code> assignment in &lt;<em>Assignment1</em>&gt;, &lt;<em>Assignment2</em>&gt;, ..., &lt;<em>AssignmentN</em>&gt;:</p>
<ul>
<li><code>s</code> must be in <code>Atts</code></li>
</ul>
<h3 id="rule-all-required-slots-must-be-specified">Rule: All required slots must be specified</h3>
<p>For each slot <code>s</code> in <code>Atts</code>, if <code>s.required=True</code>, then <code>i.&lt;s&gt;</code> must be neither <code>None</code> nor the empty collection <code>[]</code></p>
<h3 id="rule-all-recommended-slots-should-be-specified">Rule: All recommended slots should be specified</h3>
<p>For each slot <code>s</code> in <code>Atts</code>, if <code>s.recommended=True</code>, then <code>i.&lt;s&gt;</code> should be neither <code>None</code> nor the empty collection <code>[]</code></p>
<p>If this condition is not met, this is considered a warning rather than invalidity</p>
<h3 id="rule-assigned-values-must-conform-to-multivalued-cardinality">Rule: Assigned values must conform to multivalued cardinality</h3>
<p>For each slot <code>s</code> in <code>Atts</code>,</p>
<ul>
<li>if <code>s.multivalued</code> is True, then <code>i.&lt;s&gt;</code> must be a collection or None</li>
<li>If <code>s.multivalued</code> is False, then <code>i.&lt;s&gt;</code> must not be a collection</li>
</ul>
<h3 id="rule-values-should-be-within-stated-bounds">Rule: values should be within stated bounds</h3>
<p>For each slot <code>s</code> in <code>Atts</code>,</p>
<ul>
<li>if <code>s.maximum_value</code> is not None, then <code>i.&lt;s&gt;</code> must be a number and must be less that or equal to the maximum value</li>
<li>if <code>s.minimum_value</code> is not None, then <code>i.&lt;s&gt;</code> must be a number and must be greater that or equal to the minimum value</li>
</ul>
<h3 id="rule-values-should-equal-evaluable-expression">Rule: values should equal evaluable expression</h3>
<p>For each slot <code>s</code> in <code>Atts</code>, if <code>s.equals_expression</code> is not None, then <code>i.&lt;s&gt;</code> must equal
the value of <code>Eval(s.equals_expression)</code>. See section on expression language
for details of syntax.</p>
<p>Note: this rule can be executed in inference mode</p>
<h3 id="rule-values-should-equal-string_serialization">Rule: values should equal string_serialization</h3>
<p>For each slot <code>s</code> in <code>Atts</code>, if <code>s.string_serialization</code> is not None, then <code>i.&lt;s&gt;</code> must equal
the value of <code>Stringify(s.string_serialization)</code>. See section on expression language
for details of syntax.</p>
<h3 id="rule-values-should-equal-regular-expression-patterns">Rule: values should equal regular expression patterns</h3>
<p>Note: this rule can be executed in inference mode</p>
<h3 id="range-class-instantiation-check">Range class instantiation check</h3>
<p>For each slot <code>s</code> in <code>Atts</code>, if <code>i.&lt;s&gt;</code> is not None, and <code>s.range</code> is in <code>m*.classes</code>,
then <code>s.range</code> must be in <code>ReflexiveAncestors(Type(i.&lt;s&gt;))</code></p>
<p>Additional checks MAY be performed based on whether <code>s.inlined</code> is True</p>
<ul>
<li>if <code>s.inlined</code>, then <code>i.&lt;s&gt;</code>  SHOULD NOT be a Reference</li>
<li>if <code>s.inlined</code> is False, then EITHER:<ul>
<li><code>i.&lt;s&gt;</code>  SHOULD be a Reference</li>
<li>OR <code>i.&lt;s&gt;</code> instantiates a class <code>R</code> such that R has no slot <code>rs</code> that is declared to be an identifier. i.e. <code>rs.identifier = True</code></li>
</ul>
</li>
</ul>
<h3 id="range-type-check">Range type check</h3>
<p>For each slot <code>s</code> in <code>Atts</code>, if <code>i.&lt;s&gt;</code> is not None, and <code>s.range</code> is in <code>m*.types</code>,
where <code>i.&lt;s&gt; = *T*( **AtomicValue** )</code> must match <code>s.range</code>,</p>
<p>here <code>T.uri</code> is used to determine the type:</p>
<ul>
<li>for xsd floats, doubles, and decimals, AtomicValue must be a decimal- for xsd floats, doubles, and decimals, AtomicValue must be a decimal</li>
<li>for xsd ints, AtomicValue must be an Integer</li>
<li>for xsd dates, datetimes, and times, AtomicValue must be a string conforming to the relevant ISO type</li>
<li>for xsd booleans, AtomicValue must be True or False</li>
</ul>
<h3 id="range-enum-check">Range enum check</h3>
<p>For each slot <code>s</code> in <code>Atts</code>, if <code>i.&lt;s&gt;</code> is not None, and <code>s.range</code> is in <code>m*.enums</code>,
then <code>i.&lt;s&gt;</code> must be equal to <code>pv.text</code> for some pv in <code>m*.enums[s.range]</code></p>
<h3 id="boolean-combinations-of-expressions">Boolean combinations of expressions</h3>
<p>There are 4 boolean operator metaslots:</p>
<ul>
<li>any_of</li>
<li>exactly_one_of</li>
<li>none_of</li>
<li>all_of</li>
</ul>
<p>These can apply to classes, slots, types, or enums. The range is always a list of operand expressions
of the same type.</p>
<p>In all cases, the semantics are as follows:</p>
<ul>
<li>any_of: true if there exists a member of the operands that evaluates to true</li>
<li>for empty lists this is always false</li>
<li>exactly_one_of: true if there exists a member of the operands that evaluates to true, and all other members evaluate to false</li>
<li>for empty lists this is always false</li>
<li>none_of: true if there does not exist a member of the operands that evaluates to true</li>
<li>for empty lists this is always true</li>
<li>for lists of length 1 this is the same as the logical NOT operator</li>
<li>for lists of length 2 this is the same as the logical XOR operator</li>
<li>all_of: true if there are no members that evaluate to false</li>
<li>for empty lists this is always true</li>
</ul>
<h3 id="range-expression-checks">range expression checks</h3>
<p>For each slot <code>s</code> in <code>Atts</code>, if <code>i.&lt;s&gt;</code> is not None, and <code>RE = s.range_expression</code> is not None, then a check
<strong>CE</strong>(<code>x</code>) is performed on <code>i.&lt;s&gt;</code></p>
<h3 id="rule-evaluation">Rule evaluation</h3>
<p>For each rule <code>r</code> in <em>C</em>.rules:</p>
<ul>
<li>if <code>r.preconditions</code> is None or <code>r.preconditions</code> is satisfied, then</li>
<li><code>r.postconditions</code> are applied</li>
</ul>
<h3 id="classification-rule-evaluation">Classification Rule evaluation</h3>
<h3 id="type-designator-checks">type designator checks</h3>
<h2 id="inference-of-new-values">Inference of new values</h2>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../04derived-schemas/" title="Derived Schemas"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../06mapping/" title="Mapping of Instances">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="../04derived-schemas/" style="color: #fcfcfc">« Previous</a></span>
<span><a href="../06mapping/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script>var base_url = '../..';</script>
<script defer="" src="../../js/theme_extra.js"></script>
<script defer="" src="../../js/theme.js"></script>
<script defer="" src="../../search/main.js"></script>
<script defer="">
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>
<script src="https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js"></script><script>mermaid.initialize({});</script></body>
</html>
