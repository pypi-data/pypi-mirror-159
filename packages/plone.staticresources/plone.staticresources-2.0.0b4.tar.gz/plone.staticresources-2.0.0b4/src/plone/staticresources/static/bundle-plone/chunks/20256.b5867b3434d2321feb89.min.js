"use strict";(self.webpackChunkplone_staticresources=self.webpackChunkplone_staticresources||[]).push([[20256],{20256:function(e,t,n){n.r(t),n.d(t,{CodeJar:function(){return r}});const o=window;function r(e,t,n={}){const r=Object.assign({tab:"\t",indentOn:/[({\[]$/,moveToNewLine:/^[)}\]]/,spellcheck:!1,catchTab:!0,preserveIdent:!0,addClosing:!0,history:!0,window:o},n),s=r.window,i=s.document;let d,c,a=[],l=[],u=-1,f=!1;e.setAttribute("contenteditable","plaintext-only"),e.setAttribute("spellcheck",r.spellcheck?"true":"false"),e.style.outline="none",e.style.overflowWrap="break-word",e.style.overflowY="auto",e.style.whiteSpace="pre-wrap";let p=!1;t(e),"plaintext-only"!==e.contentEditable&&(p=!0),p&&e.setAttribute("contenteditable","true");const h=S((()=>{const n=b();t(e,n),k(n)}),30);let g=!1;const y=e=>!x(e)&&!M(e)&&"Meta"!==e.key&&"Control"!==e.key&&"Alt"!==e.key&&!e.key.startsWith("Arrow"),N=S((e=>{y(e)&&(v(),g=!1)}),300),T=(t,n)=>{a.push([t,n]),e.addEventListener(t,n)};function b(){const t=K(),n={start:0,end:0,dir:void 0};let{anchorNode:o,anchorOffset:r,focusNode:s,focusOffset:d}=t;if(!o||!s)throw"error1";if(o.nodeType===Node.ELEMENT_NODE){const e=i.createTextNode("");o.insertBefore(e,o.childNodes[r]),o=e,r=0}if(s.nodeType===Node.ELEMENT_NODE){const e=i.createTextNode("");s.insertBefore(e,s.childNodes[d]),s=e,d=0}return w(e,(e=>{if(e===o&&e===s)return n.start+=r,n.end+=d,n.dir=r<=d?"->":"<-","stop";if(e===o){if(n.start+=r,n.dir)return"stop";n.dir="->"}else if(e===s){if(n.end+=d,n.dir)return"stop";n.dir="<-"}e.nodeType===Node.TEXT_NODE&&("->"!=n.dir&&(n.start+=e.nodeValue.length),"<-"!=n.dir&&(n.end+=e.nodeValue.length))})),e.normalize(),n}function k(t){const n=K();let o,r,s=0,i=0;if(t.dir||(t.dir="->"),t.start<0&&(t.start=0),t.end<0&&(t.end=0),"<-"==t.dir){const{start:e,end:n}=t;t.start=n,t.end=e}let d=0;w(e,(e=>{if(e.nodeType!==Node.TEXT_NODE)return;const n=(e.nodeValue||"").length;if(d+n>t.start&&(o||(o=e,s=t.start-d),d+n>t.end))return r=e,i=t.end-d,"stop";d+=n})),o||(o=e,s=e.childNodes.length),r||(r=e,i=e.childNodes.length),"<-"==t.dir&&([o,s,r,i]=[r,i,o,s]),n.setBaseAndExtent(o,s,r,i)}function E(){const t=K().getRangeAt(0),n=i.createRange();return n.selectNodeContents(e),n.setEnd(t.startContainer,t.startOffset),n.toString()}function m(){const t=K().getRangeAt(0),n=i.createRange();return n.selectNodeContents(e),n.setStart(t.endContainer,t.endOffset),n.toString()}function C(e){if(p&&"Enter"===e.key)if(_(e),e.stopPropagation(),""==m()){L("\n ");const e=b();e.start=--e.end,k(e)}else L("\n")}function v(){if(!f)return;const t=e.innerHTML,n=b(),o=l[u];if(o&&o.html===t&&o.pos.start===n.start&&o.pos.end===n.end)return;u++,l[u]={html:t,pos:n},l.splice(u+1);u>300&&(u=300,l.splice(0,1))}function w(e,t){const n=[];e.firstChild&&n.push(e.firstChild);let o=n.pop();for(;o&&"stop"!==t(o);)o.nextSibling&&n.push(o.nextSibling),o.firstChild&&n.push(o.firstChild),o=n.pop()}function O(e){return e.metaKey||e.ctrlKey}function x(e){return O(e)&&!e.shiftKey&&"KeyZ"===e.code}function M(e){return O(e)&&e.shiftKey&&"KeyZ"===e.code}function L(e){e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),i.execCommand("insertHTML",!1,e)}function S(e,t){let n=0;return(...o)=>{clearTimeout(n),n=s.setTimeout((()=>e(...o)),t)}}function A(e){let t=e.length-1;for(;t>=0&&"\n"!==e[t];)t--;t++;let n=t;for(;n<e.length&&/[ \t]/.test(e[n]);)n++;return[e.substring(t,n)||"",t,n]}function D(){return e.textContent||""}function _(e){e.preventDefault()}function K(){var t;return(null===(t=e.parentNode)||void 0===t?void 0:t.nodeType)==Node.DOCUMENT_FRAGMENT_NODE?e.parentNode.getSelection():s.getSelection()}return T("keydown",(t=>{t.defaultPrevented||(c=D(),r.preserveIdent?function(e){if("Enter"===e.key){const t=E(),n=m();let[o]=A(t),s=o;if(r.indentOn.test(t)&&(s+=r.tab),s.length>0?(_(e),e.stopPropagation(),L("\n"+s)):C(e),s!==o&&r.moveToNewLine.test(n)){const e=b();L("\n"+o),k(e)}}}(t):C(t),r.catchTab&&function(e){if("Tab"===e.key)if(_(e),e.shiftKey){const e=E();let[t,n]=A(e);if(t.length>0){const e=b(),o=Math.min(r.tab.length,t.length);k({start:n,end:n+o}),i.execCommand("delete"),e.start-=o,e.end-=o,k(e)}}else L(r.tab)}(t),r.addClosing&&function(e){const t="([{'\"",n=")]}'\"",o=m(),r=E(),s="\\"===r.substr(r.length-1),i=o.substr(0,1);if(n.includes(e.key)&&!s&&i===e.key){const t=b();_(e),t.start=++t.end,k(t)}else if(t.includes(e.key)&&!s&&("\"'".includes(e.key)||[""," ","\n"].includes(i))){_(e);const o=b(),r=o.start==o.end?"":K().toString();L(e.key+r+n[t.indexOf(e.key)]),o.start++,o.end++,k(o)}}(t),r.history&&(!function(t){if(x(t)){_(t),u--;const n=l[u];n&&(e.innerHTML=n.html,k(n.pos)),u<0&&(u=0)}if(M(t)){_(t),u++;const n=l[u];n&&(e.innerHTML=n.html,k(n.pos)),u>=l.length&&u--}}(t),y(t)&&!g&&(v(),g=!0)),p&&k(b()))})),T("keyup",(e=>{e.defaultPrevented||e.isComposing||(c!==D()&&h(),N(e),d&&d(D()))})),T("focus",(e=>{f=!0})),T("blur",(e=>{f=!1})),T("paste",(n=>{v(),function(n){_(n);const o=(n.originalEvent||n).clipboardData.getData("text/plain").replace(/\r/g,""),r=b();L(o),t(e),k({start:Math.min(r.start,r.end)+o.length,end:Math.min(r.start,r.end)+o.length,dir:"<-"})}(n),v(),d&&d(D())})),{updateOptions(e){Object.assign(r,e)},updateCode(n){e.textContent=n,t(e)},onUpdate(e){d=e},toString:D,save:b,restore:k,recordHistory:v,destroy(){for(let[t,n]of a)e.removeEventListener(t,n)}}}}}]);
//# sourceMappingURL=20256.b5867b3434d2321feb89.min.js.map