"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_organizationAuditLog_index_tsx"],{"./app/components/activity/item/avatar.tsx":(e,t,s)=>{s.d(t,{Z:()=>d});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=s("./app/components/avatar/userAvatar.tsx"),a=s("./app/components/placeholder.tsx"),o=s("./app/icons/index.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l(e){let{className:t,type:s,user:n,size:o=38}=e;return n?(0,r.tZ)(i.Z,{user:n,size:o,className:t}):"system"===s?(0,r.tZ)(p,{className:t,size:o,children:(0,r.tZ)(c,{size:"md"})}):(0,r.tZ)(a.Z,{className:t,width:`${o}px`,height:`${o}px`,shape:"circle"})}l.displayName="ActivityAvatar";const d=l,p=(0,n.Z)("span",{target:"ety7k0b1"})("display:flex;justify-content:center;align-items:center;width:",(e=>e.size),"px;height:",(e=>e.size),"px;background-color:",(e=>e.theme.textColor),";color:",(e=>e.theme.background),";border-radius:50%;"),c=(0,n.Z)(o.iW,{target:"ety7k0b0"})({name:"1p2ly5v",styles:"padding-bottom:3px"})},"./app/views/settings/organizationAuditLog/index.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>M}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var n=s("../node_modules/react/index.js"),i=s("../node_modules/@sentry/hub/esm/exports.js"),a=s("./app/actionCreators/indicator.tsx"),o=s("./app/utils/useApi.tsx"),r=s("./app/utils/withOrganization.tsx"),l=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),d=s("./app/components/activity/item/avatar.tsx"),p=s("./app/components/avatar/userAvatar.tsx"),c=s("./app/components/dateTime.tsx"),m=s("./app/components/forms/selectControl.tsx"),u=s("./app/components/pagination.tsx"),g=s("./app/components/panels/index.tsx"),h=s("./app/components/tag.tsx"),v=s("./app/components/tooltip.tsx"),y=s("./app/locale.tsx"),Z=s("./app/styles/space.tsx"),x=s("./app/utils/dates.tsx"),w=s("./app/views/settings/components/settingsPageHeader.tsx"),b=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const f={width:36,height:36,marginRight:8},z=e=>null!=e&&e.isSuperuser?(0,b.BX)(A,{"data-test-id":"actor-name",children:[e.name,(0,b.tZ)(T,{children:(0,y.t)("Sentry Staff")})]}):void 0!==e?(0,b.tZ)(A,{"data-test-id":"actor-name",children:e.name}):null,L=e=>{let{isLoading:t,pageLinks:s,entries:i,eventTypes:a,onCursor:o,onEventSelect:r}=e;const l=(0,x.gn)(),d=i&&i.length>0,m=null==a?void 0:a.map((e=>({label:e,value:e}))),h=(0,b.tZ)(S,{clearable:!0,isDisabled:t,name:"eventFilter",placeholder:(0,y.t)("Select Action: "),options:m,onChange:e=>{r(null==e?void 0:e.value)}});return(0,b.BX)("div",{children:[(0,b.tZ)(w.Z,{title:(0,y.t)("Audit Log"),action:h}),(0,b.tZ)(g.KB,{headers:[(0,y.t)("Member"),(0,y.t)("Action"),(0,y.t)("IP"),(0,y.t)("Time")],isEmpty:!d&&0===(null==i?void 0:i.length),emptyMessage:(0,y.t)("No audit entries available"),isLoading:t,children:null==i?void 0:i.map((e=>{return(0,b.BX)(n.Fragment,{children:[(0,b.BX)(C,{children:[(0,b.tZ)("div",{children:(t=e.actor,null!=t&&t.isSuperuser||"Sentry"===(null==t?void 0:t.name)&&void 0===(null==t?void 0:t.email)?(0,b.tZ)(k,{type:"system",size:36}):void 0!==t?(0,b.tZ)(p.Z,{style:f,user:t}):null)}),(0,b.BX)(j,{children:[z(e.actor),(0,b.tZ)(q,{children:e.note})]})]}),(0,b.tZ)(_,{children:(0,b.tZ)(B,{children:e.event})}),(0,b.tZ)(_,{children:e.ipAddress&&(0,b.tZ)(N,{children:(0,b.tZ)(v.Z,{title:e.ipAddress,disabled:e.ipAddress.length<=15,children:(0,b.tZ)(B,{children:e.ipAddress})})})}),(0,b.BX)(E,{children:[(0,b.tZ)(c.Z,{dateOnly:!0,date:e.dateCreated}),(0,b.tZ)(c.Z,{timeOnly:!0,format:l?"HH:mm zz":"LT zz",date:e.dateCreated})]})]},e.id);var t}))}),s&&(0,b.tZ)(u.Z,{pageLinks:s,onCursor:o})]})};L.displayName="AuditLogList";const k=(0,l.Z)(d.Z,{target:"e1haq54w10"})("margin-right:",(0,Z.Z)(1),";"),A=(0,l.Z)("strong",{target:"e1haq54w9"})("font-size:",(e=>e.theme.fontSizeMedium),";"),T=(0,l.Z)(h.Z,{target:"e1haq54w8"})("padding:",(0,Z.Z)(1),";"),S=(0,l.Z)(m.Z,{target:"e1haq54w7"})({name:"xu0q36",styles:"width:250px"}),C=(0,l.Z)("div",{target:"e1haq54w6"})("display:flex;align-items:center;line-height:1.2;font-size:",(e=>e.theme.fontSizeSmall),";min-width:250px;"),j=(0,l.Z)("div",{target:"e1haq54w5"})({name:"16mmcnu",styles:"display:flex;flex-direction:column;justify-content:center"}),q=(0,l.Z)("div",{target:"e1haq54w4"})("font-size:",(e=>e.theme.fontSizeSmall),";word-break:break-word;"),_=(0,l.Z)("div",{target:"e1haq54w3"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),N=(0,l.Z)("div",{target:"e1haq54w2"})((e=>e.theme.overflowEllipsis),";min-width:90px;"),B=(0,l.Z)("code",{target:"e1haq54w1"})("font-size:",(e=>e.theme.fontSizeMedium),";white-space:no-wrap;"),E=(0,l.Z)("div",{target:"e1haq54w0"})("display:grid;grid-template-rows:auto auto;gap:",(0,Z.Z)(1),";font-size:",(e=>e.theme.fontSizeMedium),";"),P=L;function X(e){let{organization:t}=e;const[s,r]=(0,n.useState)({entryList:[],entryListPageLinks:null,eventTypes:[],isLoading:!0}),l=(0,o.Z)(),d=(0,n.useCallback)((async()=>{try{const e={cursor:s.currentCursor,event:s.eventType,version:"2"};e.cursor||delete e.cursor,e.event||delete e.event;const[n,i,a]=await l.requestPromise(`/organizations/${t.slug}/audit-logs/`,{method:"GET",includeAllArgs:!0,query:e});r((e=>{var t;return{...e,entryList:n.rows,eventTypes:n.options.sort(),isLoading:!1,entryListPageLinks:null!==(t=null==a?void 0:a.getResponseHeader("Link"))&&void 0!==t?t:null}}))}catch(e){401!==e.status&&403!==e.status&&i.Tb(e),r((e=>({...e,isLoading:!1}))),(0,a.Iw)("Unable to load audit logs.")}}),[l,t.slug,s.currentCursor,s.eventType]);return(0,n.useEffect)((()=>{d()}),[d]),(0,b.tZ)(n.Fragment,{children:(0,b.tZ)(P,{entries:s.entryList,pageLinks:s.entryListPageLinks,eventType:s.eventType,eventTypes:s.eventTypes,onEventSelect:e=>{r((t=>({...t,eventType:e})))},isLoading:s.isLoading,onCursor:e=>{r((t=>({...t,currentCursor:e})))}})})}X.displayName="OrganizationAuditLog";const M=(0,r.Z)(X)}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_organizationAuditLog_index_tsx.a9e3827d6fa5d7af41b1de0accb31785.js.map