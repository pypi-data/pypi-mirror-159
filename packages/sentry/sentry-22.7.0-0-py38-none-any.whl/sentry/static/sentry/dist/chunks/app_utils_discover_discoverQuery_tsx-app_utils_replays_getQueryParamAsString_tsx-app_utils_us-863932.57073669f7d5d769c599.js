"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_utils_discover_discoverQuery_tsx-app_utils_replays_getQueryParamAsString_tsx-app_utils_us-863932"],{"./app/utils/discover/discoverQuery.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var r=s("./app/utils/withApi.tsx"),o=s("./app/utils/discover/genericDiscoverQuery.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function n(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function a(e){const t=e.useEvents?"events":"eventsv2",s=e.useEvents?(e,t)=>{var s;const{fields:r,...o}=null!==(s=e.meta)&&void 0!==s?s:{};return{...e,meta:{...r,...o}}}:void 0;return(0,i.tZ)(o.ZP,{route:t,shouldRefetchData:n,afterFetch:s,...e})}a.displayName="DiscoverQuery";const l=(0,r.Z)(a)},"./app/utils/discover/genericDiscoverQuery.tsx":(e,t,s)=>{s.d(t,{AA:()=>m,ZP:()=>v,o:()=>d});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/react/index.js")),i=s("./app/locale.tsx"),n=s("./app/utils/discover/eventView.tsx"),a=s("./app/utils/performance/contexts/performanceEventViewContext.tsx"),l=s("./app/views/organizationContext.tsx"),u=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class d{constructor(e,t){(0,r.Z)(this,"message",void 0),(0,r.Z)(this,"originalError",void 0),this.message=e,this.originalError=t}getOriginalError(){return this.originalError}}class p extends o.Component{constructor(){super(...arguments),(0,r.Z)(this,"state",{isLoading:!0,tableFetchID:void 0,error:null,tableData:null,pageLinks:null}),(0,r.Z)(this,"_shouldRefetchData",(e=>{const t=this.getPayload(this.props),s=this.getPayload(e);return!(0,n.ze)(t,s)||e.limit!==this.props.limit||e.route!==this.props.route||e.cursor!==this.props.cursor})),(0,r.Z)(this,"_parseError",(e=>{var t;if(this.props.parseError)return this.props.parseError(e);if(!e)return null;const s=null===(t=e.responseJSON)||void 0===t?void 0:t.detail;if("string"==typeof s)return new d(s,e);const r=null==s?void 0:s.message;return new d("string"==typeof r?r:(0,i.t)("An unknown error occurred."),e)})),(0,r.Z)(this,"fetchData",(async()=>{const{api:e,beforeFetch:t,afterFetch:s,didFetch:r,eventView:o,orgSlug:i,route:n,setError:a}=this.props;if(!o.isValid())return;const l=`/organizations/${i}/${n}/`,u=Symbol("tableFetchID"),d=this.getPayload(this.props);this.setState({isLoading:!0,tableFetchID:u}),null==a||a(void 0),null==t||t(e),e.clear();try{const[t,,o]=await m(e,l,d);if(this.state.tableFetchID!==u)return;const i=s?s(t,this.props):t;null==r||r(i),this.setState((e=>{var t;return{isLoading:!1,tableFetchID:void 0,error:null,pageLinks:null!==(t=null==o?void 0:o.getResponseHeader("Link"))&&void 0!==t?t:e.pageLinks,tableData:i}}))}catch(e){const t=this._parseError(e);this.setState({isLoading:!1,tableFetchID:void 0,error:t,tableData:null}),a&&a(null!=t?t:void 0)}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){const t=this._shouldRefetchData(e),s=!1===e.eventView.isValid()&&this.props.eventView.isValid(),r=!!this.props.shouldRefetchData&&this.props.shouldRefetchData(e,this.props);(t||s||r)&&this.fetchData()}getPayload(e){var t;const{cursor:s,limit:r,noPagination:o,referrer:i}=e,n=this.props.getRequestPayload?this.props.getRequestPayload(e):e.eventView.getEventsAPIPayload(e.location);return s&&(n.cursor=s),r&&(n.per_page=r),o&&(n.noPagination=o),i&&(n.referrer=i),Object.assign(n,null!==(t=e.queryExtras)&&void 0!==t?t:{}),n}render(){const{isLoading:e,error:t,tableData:s,pageLinks:r}=this.state,o={isLoading:e,error:t,tableData:s,pageLinks:r},i=this.props.children;return null==i?void 0:i(o)}}function c(e){var t,s,r,i;const n=null===(t=(0,o.useContext)(l.g))||void 0===t?void 0:t.slug,d=null===(s=(0,o.useContext)(a.uL))||void 0===s?void 0:s.eventView,c=null!==(r=e.orgSlug)&&void 0!==r?r:n,m=null!==(i=e.eventView)&&void 0!==i?i:d;if(void 0===c||void 0===m)throw new Error("GenericDiscoverQuery requires both an orgSlug and eventView");const v={...e,orgSlug:c,eventView:m};return(0,u.tZ)(p,{...v})}function m(e,t,s){return e.requestPromise(t,{method:"GET",includeAllArgs:!0,query:{...s}})}p.displayName="_GenericDiscoverQuery",c.displayName="GenericDiscoverQuery";const v=c},"./app/utils/getUrlPathname.tsx":(e,t,s)=>{function r(e){try{return new URL(e).pathname}catch{return}}s.d(t,{Z:()=>r}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/web.url.js"),s("../node_modules/core-js/modules/web.url-search-params.js")},"./app/utils/performance/contexts/performanceEventViewContext.tsx":(e,t,s)=>{s.d(t,{bq:()=>o,uL:()=>n}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("./app/utils/performance/contexts/utils.tsx");const[o,i,n]=(0,r.n)({name:"PerformanceEventViewContext"})},"./app/utils/performance/contexts/utils.tsx":(e,t,s)=>{s.d(t,{n:()=>o}),s("../node_modules/core-js/modules/es.error.cause.js");var r=s("../node_modules/react/index.js");function o(e){const{strict:t=!0,errorMessage:s=`useContext for "${e.name}" must be inside a Provider with a value`,name:o}=e,i=(0,r.createContext)(void 0);return i.displayName=o,[i.Provider,function(){const e=(0,r.useContext)(i);if(!e&&t)throw new Error(s);return e},i]}},"./app/utils/replays/getQueryParamAsString.tsx":(e,t,s)=>{function r(e){return e?Array.isArray(e)?e.join(" "):e:""}s.d(t,{i:()=>r})},"./app/utils/replays/hooks/useDiscoveryQuery.tsx":(e,t,s)=>{s.d(t,{Z:()=>u}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("../node_modules/react/index.js"),o=s("./app/utils/discover/eventView.tsx"),i=s("./app/utils/useApi.tsx"),n=s("./app/utils/useOrganization.tsx");const a={isLoading:!0,error:void 0,data:void 0,pageLinks:void 0},l={query:{}};function u(e){let{endpoint:t,discoverQuery:s,ignoreCursor:u}=e;const[d,p]=(0,r.useState)(a),c=(0,i.Z)(),m=(0,n.Z)();return(0,r.useEffect)((()=>{!async function(){const e=t||`/organizations/${m.slug}/eventsv2/`,r=o.ZP.fromNewQueryWithLocation({environment:[],projects:[],id:"",name:"",version:2,...s},l).getEventsAPIPayload(l);p((e=>({...e,isLoading:!0,error:void 0}))),c.clear();try{const[t,,s]=await c.requestPromise(e,{includeAllArgs:!0,query:r});p((e=>{var r;return{...e,isLoading:!1,error:void 0,pageLinks:null!==(r=null==s?void 0:s.getResponseHeader("Link"))&&void 0!==r?r:e.pageLinks,data:t.data}}))}catch(e){p((t=>({...t,isLoading:!1,error:e,data:void 0})))}}()}),[t,s,m.slug,u]),d}},"./app/utils/useLocation.tsx":(e,t,s)=>{s.d(t,{T:()=>o});var r=s("./app/utils/useRouteContext.tsx");function o(){return(0,r.s)().location}},"./app/views/replays/replayTable.tsx":(e,t,s)=>{s.d(t,{Z:()=>D});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=s("../node_modules/react/index.js"),i=s("./app/components/duration.tsx"),n=s("./app/components/idBadge/projectBadge.tsx"),a=s("./app/components/idBadge/userBadge.tsx"),l=s("./app/components/links/link.tsx"),u=s("./app/components/placeholder.tsx"),d=s("./app/components/timeSince.tsx"),p=s("./app/icons/index.tsx"),c=s("./app/styles/space.tsx"),m=s("./app/utils/discover/urls.tsx"),v=s("./app/utils/getUrlPathname.tsx"),h=s("./app/utils/replays/hooks/useDiscoveryQuery.tsx"),g=s("./app/utils/theme.tsx"),y=s("./app/utils/useMedia.tsx"),x=s("./app/utils/useOrganization.tsx"),f=s("./app/utils/useProjects.tsx"),Z=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function j(e){let{replayList:t,idKey:s,showProjectColumn:r}=e;const p=(0,x.Z)(),{projects:c}=(0,f.Z)(),j=(0,y.Z)(`(min-width: ${g.ZP.breakpoints.small})`),D=t.map((e=>`replayId:${e[s]}`)).join(" OR "),P=(0,o.useMemo)((()=>({fields:["replayId","max(timestamp)","min(timestamp)","equation|max(timestamp)-min(timestamp)","count_if(event.type,equals,error)"],orderby:"-min_timestamp",query:`(title:"sentry-replay-event-*" OR event.type:error) AND (${D})`})),[D]),{data:L}=(0,h.Z)({discoverQuery:P}),E=L?Object.fromEntries(L.map((e=>[e.replayId,e]))):{};return(0,Z.tZ)(o.Fragment,{children:null==t?void 0:t.map((e=>{var t,h,g,y,x,f,D;return(0,Z.BX)(o.Fragment,{children:[(0,Z.tZ)(a.Z,{avatarSize:32,displayName:(0,Z.tZ)(l.Z,{to:`/organizations/${p.slug}/replays/${(0,m.JE)({project:e.project,id:e[s]})}/`,children:e["user.display"]}),user:{username:null!==(t=e["user.username"])&&void 0!==t?t:"",id:null!==(h=e["user.id"])&&void 0!==h?h:"",ip_address:null!==(g=e["user.ip_address"])&&void 0!==g?g:"",name:null!==(y=e["user.name"])&&void 0!==y?y:"",email:null!==(x=e["user.email"])&&void 0!==x?x:""},displayEmail:null!==(f=(0,v.Z)(e.url))&&void 0!==f?f:""}),j&&r&&(0,Z.tZ)(w,{children:(0,Z.tZ)(n.Z,{project:c.find((t=>t.slug===e.project))||{slug:e.project},avatarSize:16})}),(0,Z.tZ)(w,{children:(0,Z.BX)(b,{children:[j&&(0,Z.tZ)(_,{color:"gray500",size:"sm"}),(0,Z.tZ)(d.Z,{date:e.timestamp})]})}),L?(0,Z.BX)(o.Fragment,{children:[(0,Z.tZ)(w,{children:(0,Z.tZ)(i.Z,{seconds:Math.floor(E[e[s]]?E[e[s]]["equation[0]"]:0)||1,exact:!0,abbreviation:!0})}),(0,Z.tZ)(w,{children:E[e[s]]?null===(D=E[e[s]])||void 0===D?void 0:D.count_if_event_type_equals_error:0})]}):(0,Z.BX)(o.Fragment,{children:[(0,Z.tZ)(w,{children:(0,Z.tZ)(u.Z,{height:"24px"})}),(0,Z.tZ)(w,{children:(0,Z.tZ)(u.Z,{height:"24px"})})]})]},e.id)}))})}j.displayName="ReplayTable";const w=(0,r.Z)("div",{target:"e1imgzw02"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),b=(0,r.Z)("div",{target:"e1imgzw01"})("display:grid;grid-template-columns:repeat(2, minmax(auto, max-content));align-items:center;gap:",(0,c.Z)(1),";"),_=(0,r.Z)(p.jt,{target:"e1imgzw00"})({name:"hbxqi1",styles:"position:relative;top:-1px"}),D=j}}]);
//# sourceMappingURL=../sourcemaps/app_utils_discover_discoverQuery_tsx-app_utils_replays_getQueryParamAsString_tsx-app_utils_us-863932.371b799509ac38ea13cfefb91e404e4c.js.map