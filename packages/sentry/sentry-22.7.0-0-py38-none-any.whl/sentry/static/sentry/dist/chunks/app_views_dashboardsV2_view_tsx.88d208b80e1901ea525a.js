"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_dashboardsV2_view_tsx"],{"./app/views/dashboardsV2/orgDashboards.tsx":(s,e,a)=>{a.d(e,{Z:()=>x});var o=a("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(a("../node_modules/core-js/modules/web.dom-collections.iterator.js"),a("../node_modules/core-js/modules/es.string.replace.js"),a("../node_modules/core-js/modules/es.array.includes.js"),a("../node_modules/react-router/es/index.js")),t=a("../node_modules/lodash/isEqual.js"),d=a.n(t),n=a("./app/components/asyncComponent.tsx"),i=a("./app/components/errors/notFound.tsx"),p=a("./app/components/loadingIndicator.tsx"),l=a("./app/components/sentryDocumentTitle.tsx"),u=a("./app/locale.tsx"),h=a("./app/styles/organization.tsx"),c=a("./app/utils/analytics.tsx"),b=a("./app/views/dashboardsV2/layoutUtils.tsx"),m=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class g extends n.Z{constructor(){super(...arguments),(0,o.Z)(this,"state",{loading:!0,reloading:!1,error:!1,errors:{},dashboards:[],selectedDashboard:null})}componentDidUpdate(s){d()(s.params.dashboardId,this.props.params.dashboardId)||this.remountComponent()}getEndpoints(){const{organization:s,params:e}=this.props,a=`/organizations/${s.slug}/dashboards/`,o=[["dashboards",a]];return e.dashboardId&&(o.push(["selectedDashboard",`${a}${e.dashboardId}/`]),(0,c.ec)({eventKey:"dashboards2.view",eventName:"Dashboards2: View dashboard",organization_id:parseInt(this.props.organization.id,10),dashboard_id:e.dashboardId})),o}onDashboardUpdate(s){this.setState({selectedDashboard:s})}getDashboards(){const{dashboards:s}=this.state;return Array.isArray(s)?s:[]}onRequestSuccess(s){let{stateKey:e,data:a}=s;const{params:o,organization:t,location:d}=this.props;if(o.dashboardId||"selectedDashboard"===e)return;const n=a.length?a[0].id:"default-overview",i=`/organizations/${t.slug}/dashboard/${n}/`;r.browserHistory.replace({pathname:i,query:{...d.query}})}renderLoading(){return(0,m.tZ)(h.JH,{children:(0,m.tZ)(p.Z,{})})}renderBody(){const{children:s,organization:e}=this.props,{selectedDashboard:a,error:o}=this.state;let r=a;return e.features.includes("dashboard-grid-layout")&&(r=a?{...a,widgets:a.widgets.map(b.TE)}:null),s({error:o,dashboard:r,dashboards:this.getDashboards(),onDashboardUpdate:s=>this.onDashboardUpdate(s)})}renderError(s){return Object.values(this.state.errors).find((s=>s&&404===s.status))?(0,m.tZ)(i.Z,{}):super.renderError(s,!0)}renderComponent(){const{organization:s,location:e}=this.props;return s.features.includes("dashboards-basic")?(0,m.tZ)(l.Z,{title:(0,u.t)("Dashboards"),orgSlug:s.slug,children:super.renderComponent()}):(r.browserHistory.replace({pathname:`/organizations/${s.slug}/dashboards/`,query:{...e.query}}),null)}}const x=g},"./app/views/dashboardsV2/view.tsx":(s,e,a)=>{a.r(e),a.d(e,{DashboardBasicFeature:()=>z,default:()=>_}),a("../node_modules/core-js/modules/web.dom-collections.iterator.js"),a("../node_modules/core-js/modules/es.string.replace.js");var o=a("../node_modules/react/index.js"),r=a("../node_modules/react-router/es/index.js"),t=a("../node_modules/lodash/pick.js"),d=a.n(t),n=a("./app/actionCreators/dashboards.tsx"),i=a("./app/components/acl/feature.tsx"),p=a("./app/components/alert.tsx"),l=a("./app/components/errorBoundary.tsx"),u=a("./app/components/errors/notFound.tsx"),h=a("./app/components/loadingIndicator.tsx"),c=a("./app/locale.tsx"),b=a("./app/styles/organization.tsx"),m=a("./app/utils/useApi.tsx"),g=a("./app/utils/withOrganization.tsx"),x=a("./app/views/dashboardsV2/detail.tsx"),w=a("./app/views/dashboardsV2/orgDashboards.tsx"),y=a("./app/views/dashboardsV2/types.tsx"),Z=a("./app/views/dashboardsV2/utils.tsx"),j=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const v=["start","end","utc","period","project","environment"];function D(s){const e=(0,m.Z)(),{organization:a,params:t,location:i}=s,p=t.dashboardId,c=a.slug,[b,g]=(0,o.useState)(),[D,_]=(0,o.useState)(y.n3.VIEW);return(0,o.useEffect)((()=>{p&&"default-overview"!==p&&(0,n.a_)(e,c,p)}),[e,c,p]),(0,o.useEffect)((()=>{const s=(0,Z.y1)(i.query);g(s),s&&(_(y.n3.EDIT),r.browserHistory.replace({pathname:i.pathname,query:d()(i.query,v)}))}),[i.pathname]),(0,j.tZ)(z,{organization:a,children:(0,j.tZ)(w.Z,{api:e,location:i,params:t,organization:a,children:e=>{let{dashboard:a,dashboards:o,error:r,onDashboardUpdate:t}=e;return r?(0,j.tZ)(u.Z,{}):a?(0,j.tZ)(l.Z,{children:(0,j.tZ)(x.Z,{...s,initialState:D,dashboard:a,dashboards:o,onDashboardUpdate:t,newWidget:b,onSetNewWidget:()=>g(void 0)})}):(0,j.tZ)(h.Z,{})}})})}D.displayName="ViewEditDashboard";const _=(0,g.Z)(D),z=s=>{let{organization:e,children:a}=s;return(0,j.tZ)(i.Z,{hookName:"feature-disabled:dashboards-page",features:["organizations:dashboards-basic"],organization:e,renderDisabled:()=>(0,j.tZ)(b.JH,{children:(0,j.tZ)(p.Z,{type:"warning",children:(0,c.t)("You don't have access to this feature")})}),children:a})};z.displayName="DashboardBasicFeature"}}]);
//# sourceMappingURL=../sourcemaps/app_views_dashboardsV2_view_tsx.ae0ef833f23d5e1ee5918d50c39192d5.js.map