"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_events_searchBar_tsx-app_views_performance_transactionSummary_pageLayout_tsx"],{"./app/components/events/searchBar.tsx":(e,t,n)=>{n.d(t,{Z:()=>j}),n("../node_modules/core-js/modules/es.error.cause.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/core-js/modules/es.string.replace.js");var s=n("../node_modules/react/index.js"),r=n("../node_modules/lodash/assign.js"),a=n.n(r),o=n("../node_modules/lodash/flatten.js"),i=n.n(o),l=n("../node_modules/lodash/memoize.js"),c=n.n(l),u=n("../node_modules/lodash/omit.js"),p=n.n(u),d=n("./app/actionCreators/tags.tsx"),m=n("./app/components/smartSearchBar/index.tsx"),h=n("./app/constants/index.tsx"),g=n("./app/types/index.tsx"),v=n("./app/utils.tsx"),y=n("./app/utils/discover/fields.tsx"),f=n("./app/utils/measurements/measurements.tsx"),x=n("./app/utils/useApi.tsx"),b=n("./app/utils/withTags.tsx"),S=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const T=new RegExp(`^${h.c$}|\\${h.ir}`,"g");function Z(e){const{maxSearchItems:t,organization:n,tags:r,omitTags:o,fields:l,projectIds:u,includeSessionTagsValues:h,maxMenuHeight:b}=e,Z=(0,x.Z)();(0,s.useEffect)((()=>{var e,t;null===(e=(t=j.cache).clear)||void 0===e||e.call(t)}),[u]);const j=c()(((e,t,s)=>{const r=null==u?void 0:u.map(String);return(0,y.h1)(e.key)||(0,y.Xr)(e.key)?Promise.resolve([]):(0,d.Fo)(Z,n.slug,e.key,t,r,s,!0,h).then((e=>i()(e.filter((e=>{let{name:t}=e;return(0,v.ri)(t)})).map((e=>{let{name:t}=e;return t})))),(()=>{throw new Error("Unable to fetch event field values")}))}),((e,t)=>{let{key:n}=e;return`${n}-${t}`})),_=e=>{const t=l?Object.fromEntries(l.filter((e=>!Object.keys(y.wZ).includes(e.field)&&!(0,y.GO)(e.field))).map((e=>[e.field,{key:e.field,name:e.field}]))):{},s=n.features.includes("performance-view")?Object.assign({},e,y.wZ,t):p()(y.wZ,y.J8),i=a()({},r,s,y.jg);return i.has={key:"has",name:"Has property",values:Object.keys(i),predefined:!0},p()(i,null!=o?o:[])};return(0,S.tZ)(f.Z,{children:n=>{let{measurements:s}=n;return(0,S.tZ)(m.Z,{hasRecentSearches:!0,savedSearchType:g.L4.EVENT,onGetTagValues:j,supportedTags:_(s),prepareQuery:e=>e.replace(T,""),maxSearchItems:t,excludeEnvironment:!0,maxMenuHeight:null!=b?b:300,getFieldDoc:y.e$,...e})}})}Z.displayName="SearchBar";const j=(0,b.Z)(Z)},"./app/utils/measurements/measurements.tsx":(e,t,n)=>{n.d(t,{Z:()=>p,i:()=>c}),n("../node_modules/core-js/modules/web.dom-collections.iterator.js");var s=n("../node_modules/react/index.js"),r=n("./app/utils/performance/vitals/constants.tsx"),a=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e){return Object.fromEntries(Object.entries(e).map((e=>{let[t,n]=e;return[t,{name:n.name,key:t}]})))}const i=o(r.TT),l=o(r.r9);function c(){return{...l,...i}}function u(e){let{children:t}=e;const n=c();return(0,a.tZ)(s.Fragment,{children:t({measurements:n})})}u.displayName="Measurements";const p=u},"./app/utils/performance/histogram/utils.tsx":(e,t,n)=>{n.d(t,{GT:()=>o,_W:()=>a,te:()=>r}),n("../node_modules/core-js/modules/es.error.cause.js");var s=n("./app/utils/formatters.tsx");function r(e){return e.length>=2?e[1].bin-e[0].bin:0}function a(e){const t=r(e);return e.map((e=>{const n=e.bin;return{start:n,end:n+t}}))}function o(e){let{precision:t,type:n,additionalFieldsFn:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=e=>{switch(n){case"duration":const r=null!=t?t:e<1e3?0:3;return(0,s.g9)(e/1e3,r,!0);case"number":const a=10**(null!=t?t:0);return(Math.round((e+Number.EPSILON)*a)/a).toLocaleString();default:throw new Error(`Unable to format type: ${n}`)}};return e.map((e=>{var t;return{value:e.count,name:a(e.bin),...null!==(t=null==r?void 0:r(e.bin))&&void 0!==t?t:{}}}))}},"./app/utils/withTags.tsx":(e,t,n)=>{n.d(t,{Z:()=>l});var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),a=n("./app/stores/tagStore.tsx"),o=n("./app/utils/getDisplayName.tsx"),i=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){class t extends r.Component{constructor(){super(...arguments),(0,s.Z)(this,"state",{tags:a.Z.getAllTags()}),(0,s.Z)(this,"unsubscribe",a.Z.listen((e=>this.setState({tags:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{tags:t,...n}=this.props;return(0,i.tZ)(e,{tags:null!=t?t:this.state.tags,...n})}}return t.displayName="WithTags",(0,s.Z)(t,"displayName",`withTags(${(0,o.Z)(e)})`),t}},"./app/views/performance/breadcrumb.tsx":(e,t,n)=>{n.d(t,{Z:()=>v});var s=n("./app/components/breadcrumbs.tsx"),r=n("./app/locale.tsx"),a=n("./app/utils/queryString.tsx"),o=n("./app/views/performance/transactionSummary/tabs.tsx"),i=n("./app/views/performance/transactionSummary/transactionEvents/utils.tsx"),l=n("./app/views/performance/transactionSummary/transactionSpans/utils.tsx"),c=n("./app/views/performance/transactionSummary/transactionTags/utils.tsx"),u=n("./app/views/performance/transactionSummary/transactionVitals/utils.tsx"),p=n("./app/views/performance/transactionSummary/utils.tsx"),d=n("./app/views/performance/vitalDetail/utils.tsx"),m=n("./app/views/performance/utils.tsx"),h=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function g(e){return(0,h.tZ)(s.Z,{crumbs:function(){const t=[],{organization:n,location:s,transaction:h,vitalName:g,spanSlug:v,eventSlug:y,traceSlug:f,tab:x}=e,b={pathname:(0,m.de)(n),query:{...s.query,transaction:void 0}};if(t.push({to:b,label:(0,r.t)("Performance"),preservePageFilters:!0}),g){const e=(0,d.i4)({orgSlug:n.slug,vitalName:"fcp",projectID:(0,a.ro)(s.query.project),query:s.query});t.push({to:e,label:(0,r.t)("Vital Detail"),preservePageFilters:!0})}else if(h){const e={orgSlug:n.slug,transaction:h.name,projectID:h.project,query:s.query};switch(x){case o.Z.Tags:{const n=(0,c.vG)(e);t.push({to:n,label:(0,r.t)("Tags"),preservePageFilters:!0});break}case o.Z.Events:{const n=(0,i.xr)(e);t.push({to:n,label:(0,r.t)("All Events"),preservePageFilters:!0});break}case o.Z.WebVitals:{const n=(0,u.Pl)(e);t.push({to:n,label:(0,r.t)("Web Vitals"),preservePageFilters:!0});break}case o.Z.Spans:{const n=(0,l.hN)(e);t.push({to:n,label:(0,r.t)("Spans"),preservePageFilters:!0});break}case o.Z.TransactionSummary:default:{const n=(0,p.e1)(e);t.push({to:n,label:(0,r.t)("Transaction Summary"),preservePageFilters:!0})}}}return h&&v?t.push({to:"",label:(0,r.t)("Span Summary")}):h&&y?t.push({to:"",label:(0,r.t)("Event Details")}):f&&t.push({to:"",label:(0,r.t)("Trace View")}),t}()})}g.displayName="Breadcrumb";const v=g},"./app/views/performance/transactionSummary/pageLayout.tsx":(e,t,n)=>{n.d(t,{Ox:()=>ve,ZP:()=>be,C1:()=>xe});var s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.string.replace.js"),n("../node_modules/react/index.js")),a=n("../node_modules/react-router/es/index.js"),o=n("./app/components/acl/feature.tsx"),i=n("./app/components/alert.tsx"),l=n("./app/components/layouts/thirds.tsx"),c=n("./app/components/noProjectMessage.tsx"),u=n("./app/components/organizations/pageFilters/container.tsx"),p=n("./app/components/sentryDocumentTitle.tsx"),d=n("./app/locale.tsx"),m=n("./app/styles/organization.tsx"),h=n("./app/utils.tsx"),g=n("./app/utils/performance/contexts/performanceEventViewContext.tsx"),v=n("./app/utils/queryString.tsx"),y=n("./app/views/performance/utils.tsx"),f=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),x=(n("../node_modules/core-js/modules/es.array.includes.js"),n("./app/components/assistant/guideAnchor.tsx")),b=n("./app/components/buttonBar.tsx"),S=n("./app/components/createAlertButton.tsx"),T=n("./app/components/featureBadge.tsx"),Z=n("./app/components/idBadge/index.tsx"),j=n("./app/components/links/listLink.tsx"),_=n("./app/components/navTabs.tsx"),w=n("./app/styles/space.tsx"),E=n("./app/utils/analytics.tsx"),q=n("../node_modules/lodash/omit.js"),C=n.n(q),P=n("../node_modules/lodash/pick.js"),A=n.n(P),k=n("./app/utils/discover/genericDiscoverQuery.tsx"),N=n("./app/utils/tokenizeSearch.tsx"),I=n("./app/utils/withApi.tsx"),V=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function z(e){const{eventView:t,location:n,transaction:s,type:r}=e,a={transaction:`"${(0,h.d9)((0,N.Bn)(s))}"`,type:r},o=A()(t.getEventsAPIPayload(n),["project","environment"]);return Object.assign(a,o)}function M(e){return(0,V.tZ)(k.ZP,{route:"events-has-measurements",getRequestPayload:z,...C()(e,"children"),children:t=>{var n;let{tableData:s,...r}=t;return e.children({hasMeasurements:null!==(n=null==s?void 0:s.measurements)&&void 0!==n?n:null,...r})}})}M.displayName="HasMeasurementsQuery";const B=(0,I.Z)(M);var O=n("./app/views/performance/breadcrumb.tsx"),F=n("./app/views/performance/landing/utils.tsx"),L=n("./app/views/performance/transactionSummary/transactionAnomalies/utils.tsx"),$=n("./app/views/performance/transactionSummary/transactionEvents/utils.tsx"),U=n("./app/views/performance/transactionSummary/transactionSpans/utils.tsx"),D=n("./app/views/performance/transactionSummary/transactionTags/utils.tsx"),X=n("./app/views/performance/transactionSummary/transactionVitals/utils.tsx"),K=n("./app/views/performance/transactionSummary/tabs.tsx"),W=n("./app/components/button.tsx"),R=n("./app/components/performance/teamKeyTransaction.tsx"),G=n("./app/components/performance/teamKeyTransactionsManager.tsx"),Q=n("./app/components/tooltip.tsx"),H=n("./app/icons/index.tsx"),Y=n("./app/utils/useTeams.tsx"),J=n("./app/utils/withProjects.tsx");class ee extends r.Component{render(){var e;const{isOpen:t,keyedTeams:n,...s}=this.props,r=null!==(e=null==n?void 0:n.length)&&void 0!==e?e:0,a=(0,V.tZ)(W.ZP,{...s,icon:r?(0,V.tZ)(H.GK,{color:"yellow300",isSolid:!0}):(0,V.tZ)(H.GK,{}),children:r?(0,d.tn)("Starred for Team","Starred for Teams",r):(0,d.t)("Star for Team")});if(!t&&null!=n&&n.length){const e=n.map((e=>{let{slug:t}=e;return t})).join(", ");return(0,V.tZ)(Q.Z,{title:e,children:a})}return a}}function te(e){let{counts:t,getKeyedTeams:n,project:s,transactionName:r,...a}=e;const o=n(s.id,r);return(0,V.tZ)(R.Z,{counts:t,keyedTeams:o,title:ee,project:s,transactionName:r,...a})}function ne(e){let{eventView:t,organization:n,projects:s,...r}=e;const{teams:a,initiallyLoaded:o}=(0,Y.Z)({provideUserTeams:!0});if(1!==t.project.length)return(0,V.tZ)(ee,{isOpen:!1,disabled:!0,keyedTeams:null});const i=String(t.project[0]),l=s.find((e=>e.id===i));return(0,h.ri)(l)?(0,V.tZ)(G.z,{organization:n,teams:a,selectedTeams:["myteams"],selectedProjects:[String(i)],children:(0,V.tZ)(G.$,{children:e=>{let{isLoading:t,...s}=e;return(0,V.tZ)(te,{organization:n,project:l,isLoading:t||!o,...r,...s})}})}):(0,V.tZ)(ee,{isOpen:!1,disabled:!0,keyedTeams:null})}ee.displayName="TitleButton",te.displayName="TeamKeyTransactionButton",ne.displayName="TeamKeyTransactionButtonWrapper";const se=(0,J.Z)(ne);var re=n("./app/actionCreators/indicator.tsx"),ae=n("./app/actionCreators/modal.tsx"),oe=n("./app/views/performance/transactionSummary/transactionThresholdModal.tsx");class ie extends r.Component{constructor(){super(...arguments),(0,f.Z)(this,"state",{transactionThreshold:void 0,transactionThresholdMetric:void 0,loadingThreshold:!1}),(0,f.Z)(this,"fetchTransactionThreshold",(()=>{const{api:e,organization:t,transactionName:n}=this.props,s=this.getProject();if(!(0,h.ri)(s))return;const r=`/organizations/${t.slug}/project-transaction-threshold-override/`;this.setState({loadingThreshold:!0}),e.requestPromise(r,{method:"GET",includeAllArgs:!0,query:{project:s.id,transaction:n}}).then((e=>{let[t]=e;this.setState({loadingThreshold:!1,transactionThreshold:t.threshold,transactionThresholdMetric:t.metric})})).catch((()=>{const e=`/projects/${t.slug}/${s.slug}/transaction-threshold/configure/`;this.props.api.requestPromise(e,{method:"GET",includeAllArgs:!0,query:{project:s.id}}).then((e=>{let[t]=e;this.setState({loadingThreshold:!1,transactionThreshold:t.threshold,transactionThresholdMetric:t.metric})})).catch((e=>{var t,n;this.setState({loadingThreshold:!1});const s=null!==(t=null===(n=e.responseJSON)||void 0===n?void 0:n.threshold)&&void 0!==t?t:null;(0,re.Iw)(s)}))}))}))}componentDidMount(){this.fetchTransactionThreshold()}getProject(){const{projects:e,eventView:t}=this.props;if(!(0,h.ri)(t))return;const n=String(t.project[0]);return e.find((e=>e.id===n))}onChangeThreshold(e,t){const{onChangeThreshold:n}=this.props;this.setState({transactionThreshold:e,transactionThresholdMetric:t}),(0,h.ri)(n)&&n(e,t)}openModal(){const{organization:e,transactionName:t,eventView:n}=this.props,{transactionThreshold:s,transactionThresholdMetric:r}=this.state;(0,ae.openModal)((a=>(0,V.tZ)(oe.ZP,{...a,organization:e,transactionName:t,eventView:n,transactionThreshold:s,transactionThresholdMetric:r,onApply:(e,t)=>this.onChangeThreshold(e,t)})),{modalCss:oe.fY,backdrop:"static"})}render(){const{loadingThreshold:e}=this.state;return(0,V.tZ)(W.ZP,{onClick:()=>this.openModal(),icon:(0,V.tZ)(H.iC,{}),disabled:e,"aria-label":(0,d.t)("Settings"),"data-test-id":"set-transaction-threshold"})}}ie.displayName="TransactionThresholdButton";const le=(0,I.Z)((0,J.Z)(ie));var ce=n("./app/views/performance/transactionSummary/utils.tsx");const ue={[K.Z.WebVitals]:{eventKey:"performance_views.vitals.vitals_tab_clicked",eventName:"Performance Views: Vitals tab clicked"},[K.Z.Tags]:{eventKey:"performance_views.tags.tags_tab_clicked",eventName:"Performance Views: Tags tab clicked"},[K.Z.Events]:{eventKey:"performance_views.events.events_tab_clicked",eventName:"Performance Views: Events tab clicked"},[K.Z.Spans]:{eventKey:"performance_views.spans.spans_tab_clicked",eventName:"Performance Views: Spans tab clicked"},[K.Z.Anomalies]:{eventKey:"performance_views.anomalies.anomalies_tab_clicked",eventName:"Performance Views: Anomalies tab clicked"}};class pe extends r.Component{constructor(){super(...arguments),(0,f.Z)(this,"trackTabClick",(e=>()=>{const t=ue[e];if(!t)return;const{location:n,projects:s}=this.props;(0,E.ec)({...t,organization_id:this.props.organization.id,project_platforms:(0,y.p9)(n,s)})})),(0,f.Z)(this,"handleIncompatibleQuery",((e,t)=>{var n,s;this.trackAlertClick(t),null===(n=(s=this.props).handleIncompatibleQuery)||void 0===n||n.call(s,e,t)})),(0,f.Z)(this,"handleCreateAlertSuccess",(()=>{this.trackAlertClick()}))}trackAlertClick(e){const{organization:t}=this.props;(0,E.ec)({eventKey:"performance_views.summary.create_alert_clicked",eventName:"Performance Views: Create alert clicked",organization_id:t.id,status:e?"error":"success",errors:e,url:window.location.href})}renderCreateAlertButton(){const{eventView:e,organization:t,projects:n}=this.props;return(0,V.tZ)(S.K,{eventView:e,organization:t,projects:n,onIncompatibleQuery:this.handleIncompatibleQuery,onSuccess:this.handleCreateAlertSuccess,referrer:"performance",useAlertWizardV3:t.features.includes("alert-wizard-v3"),alertType:"trans_duration","aria-label":(0,d.t)("Create Alert")})}renderKeyTransactionButton(){const{eventView:e,organization:t,transactionName:n}=this.props;return(0,V.tZ)(se,{transactionName:n,eventView:e,organization:t})}renderSettingsButton(){const{organization:e,transactionName:t,eventView:n,onChangeThreshold:s}=this.props;return(0,V.tZ)(x.Z,{target:"project_transaction_threshold_override",position:"bottom",children:(0,V.tZ)(le,{organization:e,transactionName:t,eventView:n,onChangeThreshold:s})})}renderWebVitalsTab(){const{organization:e,eventView:t,location:n,projects:s,transactionName:r,currentTab:a,hasWebVitals:o}=this.props,i=(0,X.Pl)({orgSlug:e.slug,transaction:r,projectID:(0,v.ro)(n.query.project),query:n.query}),l=(0,V.tZ)(j.Z,{"data-test-id":"web-vitals-tab",to:i,isActive:()=>a===K.Z.WebVitals,onClick:this.trackTabClick(K.Z.WebVitals),children:(0,d.t)("Web Vitals")});switch(o){case"maybe":return(0,F.Q_)(n,s,t).field===F.BY.FRONTEND_PAGELOAD?l:(0,V.tZ)(B,{location:n,orgSlug:e.slug,eventView:t,transaction:r,type:"web",children:e=>{let{hasMeasurements:t}=e;return t?l:null}});case"yes":return l;default:return null}}render(){const{organization:e,location:t,projectId:n,transactionName:s,currentTab:a,projects:i}=this.props,c={orgSlug:e.slug,transaction:s,projectID:n,query:t.query},u=(0,ce.e1)(c),p=(0,D.vG)(c),m=(0,$.xr)(c),h=(0,U.hN)(c),g=(0,L.az)(c),v=i.find((e=>e.id===n));return(0,V.BX)(l.h4,{children:[(0,V.BX)(l.oB,{children:[(0,V.tZ)(O.Z,{organization:e,location:t,transaction:{project:n,name:s},tab:a}),(0,V.tZ)(l.Dx,{children:(0,V.BX)(me,{children:[v&&(0,V.tZ)(Z.Z,{project:v,avatarSize:28,hideName:!0,avatarProps:{hasTooltip:!0,tooltip:v.slug}}),s]})})]}),(0,V.tZ)(l.kP,{children:(0,V.BX)(b.ZP,{gap:1,children:[(0,V.tZ)(o.Z,{organization:e,features:["incidents"],children:e=>{let{hasFeature:t}=e;return t&&this.renderCreateAlertButton()}}),this.renderKeyTransactionButton(),this.renderSettingsButton()]})}),(0,V.tZ)(r.Fragment,{children:(0,V.BX)(de,{children:[(0,V.tZ)(j.Z,{to:u,isActive:()=>a===K.Z.TransactionSummary,children:(0,d.t)("Overview")}),(0,V.tZ)(j.Z,{to:m,isActive:()=>a===K.Z.Events,onClick:this.trackTabClick(K.Z.Events),children:(0,d.t)("All Events")}),(0,V.tZ)(j.Z,{to:p,isActive:()=>a===K.Z.Tags,onClick:this.trackTabClick(K.Z.Tags),children:(0,d.t)("Tags")}),(0,V.tZ)(o.Z,{organization:e,features:["organizations:performance-suspect-spans-view"],children:(0,V.tZ)(j.Z,{"data-test-id":"spans-tab",to:h,isActive:()=>a===K.Z.Spans,onClick:this.trackTabClick(K.Z.Spans),children:(0,d.t)("Spans")})}),(0,V.tZ)(o.Z,{organization:e,features:["organizations:performance-anomaly-detection-ui"],children:(0,V.BX)(j.Z,{"data-test-id":"anomalies-tab",to:g,isActive:()=>a===K.Z.Anomalies,onClick:this.trackTabClick(K.Z.Anomalies),children:[(0,d.t)("Anomalies"),(0,V.tZ)(T.Z,{type:"alpha",noTooltip:!0})]})}),this.renderWebVitalsTab()]})})]})}}pe.displayName="TransactionHeader";const de=(0,s.Z)(_.Z,{target:"ega7at51"})({name:"13jhhqe",styles:"margin-bottom:0;width:100%"}),me=(0,s.Z)("div",{target:"ega7at50"})("display:grid;grid-template-columns:max-content 1fr;grid-column-gap:",(0,w.Z)(1),";align-items:center;"),he=pe;function ge(e){const{location:t,organization:n,projects:s,tab:a,getDocumentTitle:i,generateEventView:d,childComponent:m,features:f=[]}=e,x=(0,v.ro)(t.query.project),b=(0,y.JY)(t),[S,T]=(0,r.useState)(),[Z,j]=(0,r.useState)(),[_,w]=(0,r.useState)(),[E,q]=(0,r.useState)(null);if(!(0,h.ri)(x)||!(0,h.ri)(b))return xe(n,t),null;const C=s.find((e=>e.id===x)),P=d({location:t,transactionName:b});return(0,V.tZ)(p.Z,{title:i(b),orgSlug:n.slug,projectSlug:null==C?void 0:C.slug,children:(0,V.tZ)(o.Z,{features:["performance-view",...f],organization:n,renderDisabled:ve,children:(0,V.tZ)(g.bq,{value:{eventView:P},children:(0,V.tZ)(u.Z,{shouldForceProject:(0,h.ri)(C),forceProject:C,specificProjectSlugs:(0,h.ri)(C)?[C.slug]:[],children:(0,V.tZ)(ye,{children:(0,V.BX)(c.Z,{organization:n,children:[(0,V.tZ)(he,{eventView:P,location:t,organization:n,projects:s,projectId:x,transactionName:b,currentTab:a,hasWebVitals:a===K.Z.WebVitals?"yes":"maybe",handleIncompatibleQuery:(e,t)=>{const n=e((()=>q(null)));q(n)},onChangeThreshold:(e,t)=>{j(e),w(t)}}),(0,V.BX)(l.uT,{children:[(0,h.ri)(S)&&(0,V.tZ)(fe,{type:"error",showIcon:!0,children:S}),E&&(0,V.tZ)(l.or,{fullWidth:!0,children:E}),(0,V.tZ)(m,{location:t,organization:n,projects:s,eventView:P,projectId:x,transactionName:b,setError:T,transactionThreshold:Z,transactionThresholdMetric:_})]})]})})})})})})}function ve(){return(0,V.tZ)(i.Z,{type:"warning",children:(0,d.t)("You don't have access to this feature")})}ge.displayName="PageLayout",ve.displayName="NoAccess";const ye=(0,s.Z)(m.JH,{target:"e1ehad6a1"})({name:"1hcx8jb",styles:"padding:0"}),fe=(0,s.Z)(i.Z,{target:"e1ehad6a0"})({name:"3hfw1i",styles:"grid-column:1/3;margin:0"});function xe(e,t){a.browserHistory.replace({pathname:`/organizations/${e.slug}/performance/`,query:{...t.query}})}const be=ge},"./app/views/performance/transactionSummary/tabs.tsx":(e,t,n)=>{var s;n.d(t,{Z:()=>r}),function(e){e[e.TransactionSummary=0]="TransactionSummary",e[e.WebVitals=1]="WebVitals",e[e.Tags=2]="Tags",e[e.Events=3]="Events",e[e.Spans=4]="Spans",e[e.Anomalies=5]="Anomalies"}(s||(s={}));const r=s},"./app/views/performance/transactionSummary/transactionAnomalies/utils.tsx":(e,t,n)=>{n.d(t,{ES:()=>l,az:()=>i,h2:()=>c,uT:()=>o});var s=n("./app/utils/discover/eventView.tsx"),r=n("./app/utils/queryString.tsx"),a=n("./app/utils/tokenizeSearch.tsx");const o="performance-anomaly-detection-ui";function i(e){let{orgSlug:t,transaction:n,projectID:s,query:r}=e;const a=function(e){let{orgSlug:t}=e;return`/organizations/${t}/performance/summary/anomalies/`}({orgSlug:t});return{pathname:a,query:{transaction:n,project:s,environment:r.environment,statsPeriod:r.statsPeriod,start:r.start,end:r.end,query:r.query}}}function l(e,t){return{high:t.red300,low:t.yellow300}[e]}function c(e){let{location:t,transactionName:n}=e;const o=(0,r.ro)(t.query.query,""),i=new a.MY(o);return i.setFilterValues("transaction",[n]),s.ZP.fromNewQueryWithLocation({id:void 0,version:2,name:n,fields:["tpm()"],query:i.formatString(),projects:[]},t)}},"./app/views/performance/transactionSummary/transactionEvents/utils.tsx":(e,t,n)=>{n.d(t,{Zq:()=>d,_S:()=>l,q3:()=>i,qg:()=>p,tb:()=>u,xr:()=>c}),n("../node_modules/core-js/modules/es.array.includes.js");var s=n("./app/locale.tsx"),r=n("./app/utils/queryString.tsx"),a=n("./app/views/performance/transactionSummary/filter.tsx"),o=n("./app/views/performance/transactionSummary/utils.tsx");let i;function l(e,t){const{p99:n,p95:r,p75:o,p50:l}=t||{p99:0,p95:0,p75:0,p50:0};return{[i.p50]:{name:i.p50,query:l?[["transaction.duration",`<=${l.toFixed(0)}`]]:void 0,sort:{kind:"desc",field:(0,a.T$)(e)||"transaction.duration"},label:(0,s.t)("p50")},[i.p75]:{name:i.p75,query:o?[["transaction.duration",`<=${o.toFixed(0)}`]]:void 0,sort:{kind:"desc",field:(0,a.T$)(e)||"transaction.duration"},label:(0,s.t)("p75")},[i.p95]:{name:i.p95,query:r?[["transaction.duration",`<=${r.toFixed(0)}`]]:void 0,sort:{kind:"desc",field:(0,a.T$)(e)||"transaction.duration"},label:(0,s.t)("p95")},[i.p99]:{name:i.p99,query:n?[["transaction.duration",`<=${n.toFixed(0)}`]]:void 0,sort:{kind:"desc",field:(0,a.T$)(e)||"transaction.duration"},label:(0,s.t)("p99")},[i.p100]:{name:i.p100,label:(0,s.t)("p100")}}}function c(e){let{orgSlug:t,transaction:n,projectID:s,query:r}=e;return{pathname:`/organizations/${t}/performance/summary/events/`,query:{transaction:n,project:s,environment:r.environment,statsPeriod:r.statsPeriod,start:r.start,end:r.end,query:r.query}}}function u(e){return t=(0,r.ro)(e.query.showTransactions,i.p100),Object.values(i).includes(t)?t:i.p100;var t}function p(e,t){var n,s;const r=l(t),a=null===(n=r[e].sort)||void 0===n?void 0:n.kind,o=null===(s=r[e].sort)||void 0===s?void 0:s.field,i={showTransactions:e};return a&&o&&(i.sort=`${"desc"===a?"-":""}${o}`),i}function d(e){switch(e){case o.K0.OUTLIER:return i.p100;case o.K0.SLOW:return i.p95;default:return}}!function(e){e.p50="p50",e.p75="p75",e.p95="p95",e.p99="p99",e.p100="p100"}(i||(i={}))},"./app/views/performance/transactionSummary/transactionSpans/types.tsx":(e,t,n)=>{let s,r;n.d(t,{g:()=>r,p:()=>s}),function(e){e.P50_EXCLUSIVE_TIME="p50ExclusiveTime",e.P75_EXCLUSIVE_TIME="p75ExclusiveTime",e.P95_EXCLUSIVE_TIME="p95ExclusiveTime",e.P99_EXCLUSIVE_TIME="p99ExclusiveTime"}(s||(s={})),function(e){e.COUNT="count",e.AVG_OCCURRENCE="avgOccurrence",e.SUM_EXCLUSIVE_TIME="sumExclusiveTime"}(r||(r={}))},"./app/views/performance/transactionSummary/transactionSpans/utils.tsx":(e,t,n)=>{n.d(t,{CS:()=>g,E5:()=>v,KK:()=>b,TK:()=>x,W6:()=>S,bc:()=>h,hN:()=>m,mV:()=>_,uQ:()=>j,xz:()=>T,zW:()=>Z}),n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/core-js/modules/es.string.replace.js");var s=n("../node_modules/lodash/pick.js"),r=n.n(s),a=n("./app/constants/index.tsx"),o=n("./app/locale.tsx"),i=n("./app/utils.tsx"),l=n("./app/utils/discover/eventView.tsx"),c=n("./app/utils/discover/fields.tsx"),u=n("./app/utils/queryString.tsx"),p=n("./app/utils/tokenizeSearch.tsx"),d=n("./app/views/performance/transactionSummary/transactionSpans/types.tsx");function m(e){let{orgSlug:t,transaction:n,projectID:s,query:r}=e;const a=function(e){let{orgSlug:t}=e;return`/organizations/${t}/performance/summary/spans/`}({orgSlug:t});return{pathname:a,query:{transaction:n,project:s,environment:r.environment,statsPeriod:r.statsPeriod,start:r.start,end:r.end,query:r.query}}}const h=30,g=r()(a.wh,["1h","24h","7d","14d","30d"]),v=[{prefix:(0,o.t)("Sort By"),label:(0,o.t)("Total Self Time"),field:d.g.SUM_EXCLUSIVE_TIME},{prefix:(0,o.t)("Sort By"),label:(0,o.t)("Average Count"),field:d.g.AVG_OCCURRENCE},{prefix:(0,o.t)("Sort By"),label:(0,o.t)("Total Count"),field:d.g.COUNT},{prefix:(0,o.t)("Sort By"),label:(0,o.t)("p50 Self Time"),field:d.p.P50_EXCLUSIVE_TIME},{prefix:(0,o.t)("Sort By"),label:(0,o.t)("p75 Self Time"),field:d.p.P75_EXCLUSIVE_TIME},{prefix:(0,o.t)("Sort By"),label:(0,o.t)("p95 Self Time"),field:d.p.P95_EXCLUSIVE_TIME},{prefix:(0,o.t)("Sort By"),label:(0,o.t)("p99 Self Time"),field:d.p.P99_EXCLUSIVE_TIME}],y=d.g.SUM_EXCLUSIVE_TIME;function f(e){return v.find((t=>t.field===e))||v.find((e=>e.field===y))}function x(e){var t,n;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sort";const r=null!==(t=(0,u.ro)(null==e||null===(n=e.query)||void 0===n?void 0:n[s]))&&void 0!==t?t:y;return f(r)}function b(e){return f(e.sorts.length?e.sorts[0].field:y)}function S(e){if(!(0,i.ri)(e))return;const t=e.lastIndexOf(":");return t<0?void 0:{op:e.slice(0,t),group:e.slice(t+1)}}function T(e){let{location:t,transactionName:n}=e;const s=(0,u.ro)(t.query.query,""),r=new p.MY(s);r.setFilterValues("event.type",["transaction"]),r.setFilterValues("transaction",[n]),Object.keys(r.filters).forEach((e=>{(0,c.h1)(e)&&r.removeFilter(e)}));const a=l.ZP.fromNewQueryWithLocation({id:void 0,version:2,name:n,fields:[...Object.values(d.g),...Object.values(d.p)],query:r.formatString(),projects:[]},t),o=x(t);return a.withSorts([{field:o.field,kind:"desc"}])}function Z(e){const t=e.withColumns([{kind:"function",function:["count","",void 0,void 0]}]),n=new p.MY(e.query);return Object.keys(n.filters).forEach((e=>{(0,c.h1)(e)&&n.removeFilter(e)})),t.query=n.formatString(),t}const j={[d.g.SUM_EXCLUSIVE_TIME]:["percentileArray(spans_exclusive_time, 0.75)","count()","count_unique(id)","sumArray(spans_exclusive_time)"],[d.g.AVG_OCCURRENCE]:["percentileArray(spans_exclusive_time, 0.75)","count()","count_unique(id)","equation|count() / count_unique(id)","sumArray(spans_exclusive_time)"],[d.g.COUNT]:["percentileArray(spans_exclusive_time, 0.75)","count()","count_unique(id)","sumArray(spans_exclusive_time)"],[d.p.P50_EXCLUSIVE_TIME]:["percentileArray(spans_exclusive_time, 0.5)","count()","count_unique(id)","sumArray(spans_exclusive_time)"],[d.p.P75_EXCLUSIVE_TIME]:["percentileArray(spans_exclusive_time, 0.75)","count()","count_unique(id)","sumArray(spans_exclusive_time)"],[d.p.P95_EXCLUSIVE_TIME]:["percentileArray(spans_exclusive_time, 0.95)","count()","count_unique(id)","sumArray(spans_exclusive_time)"],[d.p.P99_EXCLUSIVE_TIME]:["percentileArray(spans_exclusive_time, 0.99)","count()","count_unique(id)","sumArray(spans_exclusive_time)"]};function _(e){return e.replace("exclusive","self")}},"./app/views/performance/transactionSummary/transactionTags/utils.tsx":(e,t,n)=>{n.d(t,{Zn:()=>a,bZ:()=>o,oT:()=>c,oc:()=>l,vG:()=>i}),n("../node_modules/core-js/modules/es.array.includes.js");var s=n("./app/utils/analytics.tsx"),r=n("./app/utils/queryString.tsx");function a(e){return(0,r.ro)(e.query.tagKey)}function o(e){(0,s.ec)({eventKey:"performance_views.tags.interaction",eventName:"Performance Views: Tag Page - Interaction",organization_id:parseInt(e.id,10)})}function i(e){let{orgSlug:t,transaction:n,projectID:s,query:r}=e;const a=function(e){let{orgSlug:t}=e;return`/organizations/${t}/performance/summary/tags/`}({orgSlug:t});return{pathname:a,query:{transaction:n,project:s,environment:r.environment,statsPeriod:r.statsPeriod,start:r.start,end:r.end,query:r.query,tagKey:r.tagKey}}}function l(e){var t,n;let s=null!==(t=(0,r.ro)(null===(n=e.query)||void 0===n?void 0:n.tagSort))&&void 0!==t?t:"-frequency";return["sumdelta"].find((e=>{var t;return null===(t=s)||void 0===t?void 0:t.includes(e)}))&&(s="-frequency"),s}function c(e){const t=Object.keys(e).find((e=>e.includes("histogram")));if(!t)return;const n=t.split("_");return{histogramField:t,bucketSize:parseInt(n[n.length-3],10),offset:parseInt(n[n.length-2],10),multiplier:parseInt(n[n.length-1],10)}}},"./app/views/performance/transactionSummary/transactionThresholdModal.tsx":(e,t,n)=>{n.d(t,{ZP:()=>C,fY:()=>q});var s=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(n("../node_modules/core-js/modules/web.dom-collections.iterator.js"),n("../node_modules/react/index.js")),o=n("../node_modules/lodash/cloneDeep.js"),i=n.n(o),l=n("../node_modules/lodash/set.js"),c=n.n(l),u=n("./app/actionCreators/indicator.tsx"),p=n("./app/components/button.tsx"),d=n("./app/components/buttonBar.tsx"),m=n("./app/components/forms/controls/input.tsx"),h=n("./app/components/forms/field/index.tsx"),g=n("./app/components/forms/selectControl.tsx"),v=n("./app/components/links/link.tsx"),y=n("./app/locale.tsx"),f=n("./app/styles/space.tsx"),x=n("./app/utils.tsx"),b=n("./app/utils/withApi.tsx"),S=n("./app/utils/withProjects.tsx"),T=n("./app/views/performance/transactionSummary/utils.tsx"),Z=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");let j;!function(e){e.TRANSACTION_DURATION="duration",e.LARGEST_CONTENTFUL_PAINT="lcp"}(j||(j={}));const _=[{label:(0,y.t)("Transaction Duration"),value:"duration"},{label:(0,y.t)("Largest Contentful Paint"),value:"lcp"}];class w extends a.Component{constructor(){super(...arguments),(0,s.Z)(this,"state",{threshold:this.props.transactionThreshold,metric:this.props.transactionThresholdMetric,error:null}),(0,s.Z)(this,"handleApply",(e=>{e.preventDefault();const{api:t,closeModal:n,organization:s,transactionName:r,onApply:a}=this.props,o=this.getProject();if(!(0,x.ri)(o))return;const i=`/organizations/${s.slug}/project-transaction-threshold-override/`;t.requestPromise(i,{method:"POST",includeAllArgs:!0,query:{project:o.id},data:{transaction:r,threshold:this.state.threshold,metric:this.state.metric}}).then((()=>{n(),a&&a(this.state.threshold,this.state.metric)})).catch((e=>{var t,n,s,r;this.setState({error:e});const a=null!==(t=null!==(n=null===(s=e.responseJSON)||void 0===s?void 0:s.threshold)&&void 0!==n?n:null===(r=e.responseJSON)||void 0===r?void 0:r.non_field_errors)&&void 0!==t?t:null;(0,u.Iw)(a)}))})),(0,s.Z)(this,"handleFieldChange",(e=>t=>{this.setState((n=>{const s=i()(n);return c()(s,e,t),{...s,errors:void 0}}))})),(0,s.Z)(this,"handleReset",(e=>{e.preventDefault();const{api:t,closeModal:n,organization:s,transactionName:r,onApply:a}=this.props,o=this.getProject();if(!(0,x.ri)(o))return;const i=`/organizations/${s.slug}/project-transaction-threshold-override/`;t.requestPromise(i,{method:"DELETE",includeAllArgs:!0,query:{project:o.id},data:{transaction:r}}).then((()=>{const e=`/projects/${s.slug}/${o.slug}/transaction-threshold/configure/`;this.props.api.requestPromise(e,{method:"GET",includeAllArgs:!0,query:{project:o.id}}).then((e=>{let[t]=e;this.setState({threshold:t.threshold,metric:t.metric}),n(),a&&a(this.state.threshold,this.state.metric)})).catch((e=>{var t,n;const s=null!==(t=null===(n=e.responseJSON)||void 0===n?void 0:n.threshold)&&void 0!==t?t:null;(0,u.Iw)(s)}))})).catch((e=>{this.setState({error:e})}))}))}getProject(){const{projects:e,eventView:t,project:n}=this.props;if((0,x.ri)(n))return e.find((e=>e.id===n));const s=String(t.project[0]);return e.find((e=>e.id===s))}renderModalFields(){return(0,Z.BX)(a.Fragment,{children:[(0,Z.tZ)(h.Z,{"data-test-id":"response-metric",label:(0,y.t)("Calculation Method"),inline:!1,help:(0,y.t)("This determines which duration metric is used for the Response Time Threshold."),showHelpInTooltip:!0,flexibleControlStateSize:!0,stacked:!0,required:!0,children:(0,Z.tZ)(g.Z,{required:!0,options:_.slice(),name:"responseMetric",label:(0,y.t)("Calculation Method"),value:this.state.metric,onChange:e=>{this.handleFieldChange("metric")(e.value)}})}),(0,Z.tZ)(h.Z,{"data-test-id":"response-time-threshold",label:(0,y.t)("Response Time Threshold (ms)"),inline:!1,help:(0,y.t)("The satisfactory response time for the calculation method defined above. This is used to calculate Apdex and User Misery scores."),showHelpInTooltip:!0,flexibleControlStateSize:!0,stacked:!0,required:!0,children:(0,Z.tZ)(m.Z,{type:"number",name:"threshold",required:!0,pattern:"[0-9]*(\\.[0-9]*)?",onChange:e=>{this.handleFieldChange("threshold")(e.target.value)},value:this.state.threshold,step:100,min:100})})]})}render(){const{Header:e,Body:t,Footer:n,organization:s,transactionName:r,eventView:o}=this.props,i=this.getProject(),l=o.clone();l.query=l.getQueryWithAdditionalConditions();const c=(0,T.e1)({orgSlug:s.slug,transaction:r,query:l.generateQueryStringObject(),projectID:null==i?void 0:i.id});return(0,Z.BX)(a.Fragment,{children:[(0,Z.tZ)(e,{closeButton:!0,children:(0,Z.tZ)("h4",{children:(0,y.t)("Transaction Settings")})}),(0,Z.BX)(t,{children:[(0,Z.tZ)(E,{children:(0,y._N)("The changes below will only be applied to [transaction]. To set it at a more global level, go to [projectSettings: Project Settings].",{transaction:(0,Z.tZ)(v.Z,{to:c,children:r}),projectSettings:(0,Z.tZ)(v.Z,{to:`/settings/${s.slug}/projects/${null==i?void 0:i.slug}/performance/`})})}),this.renderModalFields()]}),(0,Z.tZ)(n,{children:(0,Z.BX)(d.ZP,{gap:1,children:[(0,Z.tZ)(p.ZP,{priority:"default",onClick:this.handleReset,"data-test-id":"reset-all",children:(0,y.t)("Reset All")}),(0,Z.tZ)(p.ZP,{"aria-label":(0,y.t)("Apply"),priority:"primary",onClick:this.handleApply,"data-test-id":"apply-threshold",children:(0,y.t)("Apply")})]})})]})}}w.displayName="TransactionThresholdModal";const E=(0,r.Z)("div",{target:"ezg6l150"})("margin-bottom:",(0,f.Z)(4),";"),q={name:"9w3zq5",styles:"width:100%;max-width:650px;margin:70px auto"},C=(0,b.Z)((0,S.Z)(w))},"./app/views/performance/transactionSummary/transactionVitals/utils.tsx":(e,t,n)=>{n.d(t,{A1:()=>c,L0:()=>i,Pl:()=>r,eH:()=>o,jb:()=>l,oZ:()=>a});var s=n("./app/utils/performance/histogram/utils.tsx");function r(e){let{orgSlug:t,transaction:n,projectID:s,query:r}=e;const a=function(e){let{orgSlug:t}=e;return`/organizations/${t}/performance/summary/vitals/`}({orgSlug:t});return{pathname:a,query:{transaction:n,project:s,environment:r.environment,statsPeriod:r.statsPeriod,start:r.start,end:r.end,query:r.query}}}function a(e,t){const n=(0,s.te)(e);return!e.length||t>=e[e.length-1].bin+n?null:t<e[0].bin?-1:Math.floor((t-e[0].bin)/n)}function o(e){if(e.length<2)return null;for(let t=0;t<e.length;t++){const n=e[t];for(let s=t+1;s<e.length;s++){const r=e[s];if(n.bin!==r.bin&&n.count!==r.count)return{point1:{x:t,y:Math.min(n.count,r.count)},point2:{x:s,y:Math.max(n.count,r.count)}}}}return{point1:{x:0,y:0},point2:{x:1,y:1}}}function i(e,t){const n=e.convertToPixel({xAxisIndex:0,yAxisIndex:0},[t.point1.x,t.point1.y]);if(isNaN(null==n?void 0:n[0])||isNaN(null==n?void 0:n[1]))return null;const s=e.convertToPixel({xAxisIndex:0,yAxisIndex:0},[t.point2.x,t.point2.y]);return isNaN(null==s?void 0:s[0])||isNaN(null==s?void 0:s[1])?null:{point1:{x:n[0],y:n[1]},point2:{x:s[0],y:s[1]}}}function l(e,t,n){if(t.point1.x===t.point2.x||t.point1.y===t.point2.y||n.point1.x===n.point2.x||n.point1.y===n.point2.y)return null;const s=(e.x-t.point1.x)/(t.point2.x-t.point1.x),r=(e.y-t.point1.y)/(t.point2.y-t.point1.y);return{x:n.point1.x+(n.point2.x-n.point1.x)*s,y:n.point1.y+(n.point2.y-n.point1.y)*r}}function c(e,t){return!(e&&!t.some((t=>!e[t])))||Object.values(e).filter((e=>0===e.total)).length>0}}}]);
//# sourceMappingURL=../sourcemaps/app_components_events_searchBar_tsx-app_views_performance_transactionSummary_pageLayout_tsx.fc5c363d6384908eae01b97d3c84b2d6.js.map