"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_alerts_rules_metric_types_tsx-app_views_projectInstall_newProject_tsx"],{"./app/utils/slugify.tsx":(e,t,a)=>{function r(e){return"string"==typeof e?e.toLowerCase().replace(" ","-"):""}a.d(t,{Z:()=>r}),a("../node_modules/core-js/modules/es.string.replace.js")},"./app/views/alerts/rules/metric/types.tsx":(e,t,a)=>{a.d(t,{F4:()=>o,GM:()=>l,LO:()=>h,Lm:()=>g,Tb:()=>m,Us:()=>u,XH:()=>d,Yh:()=>c,hd:()=>E,lK:()=>p,lT:()=>s,qz:()=>i,t6:()=>n});var r=a("./app/locale.tsx");let s,o,n,i,l,c,p,d,m,u;!function(e){e[e.ABOVE=0]="ABOVE",e[e.BELOW=1]="BELOW"}(s||(s={})),function(e){e.CRITICAL="critical",e.WARNING="warning",e.RESOLVE="resolve"}(o||(o={})),function(e){e.COUNT="count",e.CHANGE="change"}(n||(n={})),function(e){e.ERRORS="events",e.TRANSACTIONS="transactions",e.SESSIONS="sessions",e.METRICS="metrics"}(i||(i={})),function(e){e.DEFAULT="default",e.ERROR="error",e.TRANSACTION="transaction",e.USER="user",e.SESSION="session"}(l||(l={})),function(e){e.ERROR_DEFAULT="error_default",e.DEFAULT="default",e.ERROR="error",e.TRANSACTION="transaction"}(c||(c={})),function(e){e.CRASH_FREE_SESSIONS="percentage(sessions_crashed, sessions) AS _crash_rate_alert_aggregate",e.CRASH_FREE_USERS="percentage(users_crashed, users) AS _crash_rate_alert_aggregate"}(p||(p={})),function(e){e.SIX_HOURS="6h",e.ONE_DAY="1d",e.THREE_DAYS="3d",e.SEVEN_DAYS="10000m",e.FOURTEEN_DAYS="14d",e.THIRTY_DAYS="30d"}(d||(d={})),function(e){e[e.ONE_MINUTE=1]="ONE_MINUTE",e[e.FIVE_MINUTES=5]="FIVE_MINUTES",e[e.TEN_MINUTES=10]="TEN_MINUTES",e[e.FIFTEEN_MINUTES=15]="FIFTEEN_MINUTES",e[e.THIRTY_MINUTES=30]="THIRTY_MINUTES",e[e.ONE_HOUR=60]="ONE_HOUR",e[e.TWO_HOURS=120]="TWO_HOURS",e[e.FOUR_HOURS=240]="FOUR_HOURS",e[e.ONE_DAY=1440]="ONE_DAY"}(m||(m={})),function(e){e.EMAIL="email",e.SLACK="slack",e.PAGERDUTY="pagerduty",e.MSTEAMS="msteams",e.SENTRY_APP="sentry_app"}(u||(u={}));const h={[u.EMAIL]:(0,r.t)("Emaiâ€‹l"),[u.SLACK]:(0,r.t)("Slack"),[u.PAGERDUTY]:(0,r.t)("Pagerduty"),[u.MSTEAMS]:(0,r.t)("MS Teams"),[u.SENTRY_APP]:(0,r.t)("Notification")};let g;!function(e){e.SPECIFIC="specific",e.USER="user",e.TEAM="team",e.SENTRY_APP="sentry_app"}(g||(g={}));const E={[g.USER]:(0,r.t)("Member"),[g.TEAM]:(0,r.t)("Team")}},"./app/views/projectInstall/newProject.tsx":(e,t,a)=>{a.r(t),a.d(t,{default:()=>B});var r=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=a("./app/components/sentryDocumentTitle.tsx"),o=a("./app/styles/space.tsx"),n=a("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(a("../node_modules/core-js/modules/es.array.includes.js"),a("../node_modules/core-js/modules/web.dom-collections.iterator.js"),a("../node_modules/react/index.js")),l=a("../node_modules/react-router/es/index.js"),c=a("../node_modules/@sentry/hub/esm/exports.js"),p=a("../node_modules/platformicons/build/index.js"),d=a("./app/actionCreators/modal.tsx"),m=a("./app/actions/projectActions.tsx"),u=a("./app/components/alert.tsx"),h=a("./app/components/button.tsx"),g=a("./app/components/forms/teamSelector.tsx"),E=a("./app/components/pageHeading.tsx"),S=a("./app/components/platformPicker.tsx"),_=a("./app/data/platformCategories.tsx"),f=a("./app/icons/index.tsx"),T=a("./app/locale.tsx"),x=a("./app/styles/input.tsx"),Z=a("./app/utils/analytics.tsx"),N=a("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),y=a("./app/utils/getPlatformName.tsx"),j=a("./app/utils/slugify.tsx"),R=a("./app/utils/withApi.tsx"),v=a("./app/utils/withOrganization.tsx"),A=a("./app/utils/getDisplayName.tsx"),O=a("./app/utils/useTeams.tsx"),C=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");var P=a("./app/views/projectInstall/issueAlertOptions.tsx"),I=a("./app/views/alerts/rules/metric/presets.tsx");class w extends i.Component{constructor(e,t){super(e,t),(0,n.Z)(this,"createProject",(async e=>{e.preventDefault();const{organization:t,api:a}=this.props,{projectName:r,platform:s,team:o,dataFragment:n}=this.state,{slug:i}=t,{shouldCreateCustomRule:p,name:d,conditions:u,actions:h,actionMatch:g,frequency:E,defaultRules:S,metricAlertPresets:_}=n||{};this.setState({inFlight:!0}),r||c.$e((e=>{e.setExtra("props",this.props),e.setExtra("state",this.state),c.uT("No project name")}));try{const e=await a.requestPromise(`/teams/${i}/${o}/projects/`,{method:"POST",data:{name:r,platform:s,default_rules:null==S||S}});let n;if(p&&(n=(await a.requestPromise(`/projects/${t.slug}/${e.slug}/rules/`,{method:"POST",data:{name:d,conditions:u,actions:h,actionMatch:g,frequency:E}})).id),t.experiments.MetricAlertOnProjectCreationExperiment&&_&&_.length>0){const r=I.g.filter((e=>_.includes(e.id))),s=this.props.teams.find((e=>e.slug===o));await Promise.all([r.map((r=>{const o=r.makeUnqueriedContext({...e,teams:s?[s]:[]},t);return a.requestPromise(`/projects/${t.slug}/${e.slug}/alert-rules/?referrer=create_project`,{method:"POST",data:{aggregate:o.aggregate,comparisonDelta:o.comparisonDelta,dataset:o.dataset,eventTypes:o.eventTypes,name:o.name,owner:null,projectId:e.id,projects:[e.slug],query:"",resolveThreshold:null,thresholdPeriod:1,thresholdType:o.thresholdType,timeWindow:o.timeWindow,triggers:o.triggers}})}))])}this.trackIssueAlertOptionSelectedEvent(e,S,p,n),m.Z.createSuccess(e);const c=s||"other",f=`/${t.slug}/${e.slug}/getting-started/${c}/`;l.browserHistory.push(f)}catch(e){this.setState({inFlight:!1,error:e.responseJSON.detail}),403!==e.status&&409!==e.status&&c.$e((t=>{t.setExtra("err",e),t.setExtra("props",this.props),t.setExtra("state",this.state),c.uT("Project creation failed")}))}})),(0,n.Z)(this,"setPlatform",(e=>this.setState((t=>{let{projectName:a,platform:r}=t;return{platform:e,projectName:!a||r&&(0,y.Z)(r)===a?(0,y.Z)(e)||"":a}}))));const{teams:a,location:r}=e,{query:s}=r,o=a.filter((e=>e.hasAccess)),i=s.team||o.length&&o[0].slug,p=(0,y.Z)(s.platform)?s.platform:"";this.state={error:!1,projectName:(0,y.Z)(p)||"",team:i,platform:p,inFlight:!1,dataFragment:void 0}}get defaultCategory(){const{query:e}=this.props.location;return t=e.category,null===(a=_.ZP.find((e=>{let{id:a}=e;return a===t})))||void 0===a?void 0:a.id;var t,a}componentDidMount(){(0,N.Z)("project_creation_page.viewed",{organization:this.props.organization})}renderProjectForm(){const{organization:e}=this.props,{projectName:t,platform:a,team:r}=this.state,s=(0,C.BX)(F,{onSubmit:this.createProject,children:[(0,C.BX)("div",{children:[(0,C.tZ)(U,{children:(0,T.t)("Project name")}),(0,C.BX)(D,{children:[(0,C.tZ)(M,{platform:null!=a?a:""}),(0,C.tZ)("input",{type:"text",name:"name",placeholder:(0,T.t)("project-name"),autoComplete:"off",value:t,onChange:e=>this.setState({projectName:(0,j.Z)(e.target.value)})})]})]}),(0,C.BX)("div",{children:[(0,C.tZ)(U,{children:(0,T.t)("Team")}),(0,C.BX)(k,{children:[(0,C.tZ)(g.Z,{name:"select-team",clearable:!1,value:r,placeholder:(0,T.t)("Select a Team"),onChange:e=>this.setState({team:e.value}),teamFilter:e=>e.hasAccess}),(0,C.tZ)(h.ZP,{borderless:!0,"data-test-id":"create-team",type:"button",icon:(0,C.tZ)(f.N_,{isCircled:!0}),onClick:()=>(0,d.openCreateTeamModal)({organization:e,onClose:e=>{let{slug:t}=e;return this.setState({team:t})}}),title:(0,T.t)("Create a team"),"aria-label":(0,T.t)("Create a team")})]})]}),(0,C.tZ)("div",{children:(0,C.tZ)(h.ZP,{"data-test-id":"create-project",priority:"primary",disabled:!this.canSubmitForm,children:(0,T.t)("Create Project")})})]});return(0,C.BX)(i.Fragment,{children:[(0,C.tZ)(E.Z,{withMargins:!0,children:(0,T.t)("Give your project a name")}),s]})}get canSubmitForm(){var e;const{projectName:t,team:a,inFlight:r}=this.state,{shouldCreateCustomRule:s,conditions:o}=this.state.dataFragment||{};return!r&&a&&""!==t&&(!s||(null==o||null===(e=o.every)||void 0===e?void 0:e.call(o,(e=>e.value))))}trackIssueAlertOptionSelectedEvent(e,t,a,r){const{organization:s}=this.props;let o={eventKey:"new_project.alert_rule_selected",eventName:"New Project Alert Rule Selected",organization_id:s.id,project_id:e.id,rule_type:t?"Default":a?"Custom":"No Rule"};void 0!==r&&(o={...o,custom_rule_id:r}),(0,Z.ec)(o)}render(){const{platform:e,error:t}=this.state;return(0,C.BX)(i.Fragment,{children:[t&&(0,C.tZ)(u.Z,{type:"error",children:t}),(0,C.BX)("div",{"data-test-id":"onboarding-info",children:[(0,C.tZ)(E.Z,{withMargins:!0,children:(0,T.t)("Create a new Project")}),(0,C.tZ)(H,{children:(0,T.t)("Projects allow you to scope error and transaction events to a specific\n               application in your organization. For example, you might have separate\n               projects for your API server and frontend client.")}),(0,C.tZ)(E.Z,{withMargins:!0,children:(0,T.t)("Choose a platform")}),(0,C.tZ)(S.Z,{platform:e,defaultCategory:this.defaultCategory,setPlatform:this.setPlatform,organization:this.props.organization,showOther:!0}),(0,C.tZ)(P.Z,{onChange:e=>{this.setState({dataFragment:e})}}),this.renderProjectForm()]})]})}}w.displayName="CreateProject";const b=(0,R.Z)((0,l.withRouter)((0,v.Z)((e=>{const t=t=>{const{teams:a}=(0,O.Z)();return(0,C.tZ)(e,{teams:a,...t})};return t.displayName=`withTeams(${(0,A.Z)(e)})`,t})(w)))),F=(0,r.Z)("form",{target:"e1icdt8d5"})("display:grid;grid-template-columns:300px minmax(250px, max-content) max-content;gap:",(0,o.Z)(2),";align-items:end;padding:",(0,o.Z)(3)," 0;box-shadow:0 -1px 0 rgba(0, 0, 0, 0.1);background:",(e=>e.theme.background),";"),U=(0,r.Z)("div",{target:"e1icdt8d4"})("font-size:",(e=>e.theme.fontSizeExtraLarge),";margin-bottom:",(0,o.Z)(1),";"),M=(0,r.Z)(p.v,{target:"e1icdt8d3"})("margin-right:",(0,o.Z)(1),";"),D=(0,r.Z)("div",{target:"e1icdt8d2"})((e=>(0,x.T)(e)),";padding:5px 10px;display:flex;align-items:center;input{background:",(e=>e.theme.background),";border:0;outline:0;flex:1;}"),k=(0,r.Z)("div",{target:"e1icdt8d1"})("display:grid;gap:",(0,o.Z)(1),";grid-template-columns:1fr min-content;align-items:center;"),H=(0,r.Z)("p",{target:"e1icdt8d0"})("color:",(e=>e.theme.subText),";max-width:760px;"),Y=()=>(0,C.tZ)(s.Z,{children:(0,C.tZ)(L,{children:(0,C.tZ)("div",{className:"container",children:(0,C.tZ)(z,{children:(0,C.tZ)(b,{})})})})});Y.displayName="NewProject";const L=(0,r.Z)("div",{target:"escx7041"})("flex:1;background:",(e=>e.theme.background),";"),z=(0,r.Z)("div",{target:"escx7040"})("margin-top:",(0,o.Z)(3),";"),B=Y}}]);
//# sourceMappingURL=../sourcemaps/app_views_alerts_rules_metric_types_tsx-app_views_projectInstall_newProject_tsx.f0c452d6b82b02772ccc84f7a1886a4e.js.map